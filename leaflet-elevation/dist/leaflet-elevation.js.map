{"version":3,"file":"leaflet-elevation.js","sources":["../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/utils.js","../src/components.js","../src/chart.js","../src/marker.js","../src/summary.js","../src/options.js","../src/control.js","../src/distance.js","../src/time.js","../src/altitude.js","../src/slope.js","../src/speed.js","../src/acceleration.js","../src/index.js"],"sourcesContent":["// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","const SEC  = 1000;\nconst MIN  = SEC * 60;\nconst HOUR = MIN * 60;\nconst DAY  = HOUR * 24;\n\n/**\n * Convert a duration time (millis) to a human readable string (%Dd %H:%M'%S\")\n */\nexport function formatTime(t) {\n\tlet d = Math.floor(t / DAY);\n\tlet h = Math.floor( (t - d * DAY) / HOUR);\n\tlet m = Math.floor( (t - d * DAY - h * HOUR) / MIN);\n\tlet s = Math.round( (t - d * DAY - h * HOUR - m * MIN) / SEC);\n\tif ( s === 60 ) { m++; s = 0; }\n\tif ( m === 60 ) { h++; m = 0; }\n\tif ( h === 24 ) { d++; h = 0; }\n\treturn (d ? d + \"d \" : '') + h.toString().padStart(2, 0) + ':' + m.toString().padStart(2, 0) + \"'\" + s.toString().padStart(2, 0) + '\"';\n}\n\n/**\n * Generate download data event.\n */\n export function saveFile(dataURI, fileName) {\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\n\tlet b = document.body;\n\tb.appendChild(a);\n\ta.click();\n\tb.removeChild(a);\n}\n\n/**\n * Async JS script download.\n */\nexport function lazyLoader(url, skip, loader) {\n\tif (skip === false) {\n\t\treturn Promise.resolve();\n\t}\n\tif (loader instanceof Promise) {\n\t\treturn loader;\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet tag = document.createElement(\"script\");\n\t\ttag.addEventListener('load', resolve, { once: true });\n\t\ttag.src = url;\n\t\tdocument.head.appendChild(tag);\n\t});\n}\n\n/**\n * Convert SVG Path into Path2D and then update canvas\n */\n export function drawCanvas(ctx, path) {\n\tpath.classed('canvas-path', true);\n\n\tctx.beginPath();\n\tctx.moveTo(0, 0);\n\tlet p = new Path2D(path.attr('d'));\n\n\tctx.strokeStyle = path.attr('stroke');\n\tctx.fillStyle   = path.attr('fill');\n\tctx.lineWidth   = 1.25;\n\tctx.globalCompositeOperation = 'source-over';\n\n\t// stroke opacity\n\tctx.globalAlpha = path.attr('stroke-opacity') || 0.3;\n\tctx.stroke(p);\n\n\t// fill opacity\n\tctx.globalAlpha = path.attr('fill-opacity')   || 0.45;\n\tctx.fill(p);\n\n\tctx.globalAlpha = 1;\n\n\tctx.closePath();\n}\n\n/**\n * Limit a number between min / max values\n */\n export function clamp(val, range) {\n\tif (range) return val < range[0] ? range[0] : val > range[1] ? range[1] : val;\n\treturn val;\n}\n\n/**\n * A little bit safier than L.DomUtil.addClass\n */\nexport function addClass(targetNode, className) {\n\tif (targetNode) className.split(\" \").every(s => s && L.DomUtil.addClass(targetNode, s));\n}\n\n/**\n * A little bit safier than L.DomUtil.removeClass()\n */\nexport function removeClass(targetNode, className) {\n\tif (targetNode) className.split(\" \").every(s => s && L.DomUtil.removeClass(targetNode, s));\n}\n\nexport function toggleClass(targetNode, className, conditional) {\n\treturn (conditional ? addClass : removeClass).call(null, targetNode, className)\n}\n\nexport function replaceClass(targetNode, removeClassName, addClassName) {\n\tif (removeClassName) removeClass(targetNode, removeClassName);\n\tif (addClassName) addClass(targetNode, addClassName);\n}\n\nexport function style(targetNode, name, value) {\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\n\telse return targetNode.style.setProperty(name, value);\n}\n\nexport function toggleStyle(targetNode, name, value, conditional) {\n\treturn style(targetNode, name, conditional ? value : '');\n}\n\nexport function toggleEvent(leafletElement, eventName, handler, conditional) {\n\treturn leafletElement[conditional ? 'on' : 'off'](eventName, handler);\n}\n\n/**\n * A little bit shorter than L.DomUtil.create()\n */\nexport function create(tagName, className, attributes, parent) {\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\n\tif (attributes) setAttributes(elem, attributes);\n\tif (parent) append(parent, elem);\n\treturn elem;\n}\n\n/**\n * Same as node.appendChild()\n */\nexport function append(parent, child) {\n\treturn parent.appendChild(child);\n}\n\n/**\n * Same as node.insertAdjacentElement()\n */\nexport function insert(parent, child, position) {\n\treturn parent.insertAdjacentElement(position, child);\n}\n\n/**\n * Loop for node.setAttribute()\n */\nexport function setAttributes(elem, attrs) {\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\n}\n\n/**\n * Same as node.querySelector().\n */\nexport function select(selector, context) {\n\treturn (context || document).querySelector(selector);\n}\n\n/**\n * Alias for L.DomEvent.on.\n */\nexport const on = L.DomEvent.on;\n\n/**\n * Alias for L.DomEvent.off.\n */\nexport const off = L.DomEvent.off;\n\n/**\n * Alias for L.DomUtil.hasClass.\n */\nexport const hasClass = L.DomUtil.hasClass;\n\n\n/**\n * Generate a random string\n */\nexport function randomId() {\n\treturn Math.random().toString(36).substr(2, 9);\n}\n\n/**\n * Execute a function foreach element in object\n */\nexport function each(obj, fn) {\n\tfor (let i in obj) fn(obj[i], i);\n}","export const Colors = {\n\t'lightblue': { area: '#3366CC', alpha: 0.45, stroke: '#3366CC' },\n\t'magenta'  : { area: '#FF005E' },\n\t'yellow'   : { area: '#FF0' },\n\t'purple'   : { area: '#732C7B' },\n\t'steelblue': { area: '#4682B4' },\n\t'red'      : { area: '#F00' },\n\t'lime'     : { area: '#9CC222', line: '#566B13' }\n};\n\nexport const Area = ({\n\twidth,\n\theight,\n\txAttr,\n\tyAttr,\n\tscaleX,\n\tscaleY,\n\tinterpolation = \"curveLinear\"\n}) => {\n\treturn d3.area()\n\t\t.curve(typeof interpolation === 'string' ? d3[interpolation] : interpolation)\n\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\n\t\t.y0(height)\n\t\t.y1(d => scaleY(d[yAttr]));\n};\n\nexport const Path = ({\n\tname,\n\tcolor,\n\tstrokeColor,\n\tstrokeOpacity,\n\tfillOpacity,\n}) => {\n\tlet path = d3.create('svg:path')\n\n\tif (name) path.classed(name, true);\n\n\tpath.style(\"pointer-events\", \"none\");\n\n\tpath\n\t.attr(\"fill\", color || '#3366CC')\n\t.attr(\"stroke\", strokeColor || '#000')\n\t.attr(\"stroke-opacity\", strokeOpacity || '1')\n\t.attr(\"fill-opacity\", fillOpacity || '0.8');\n\n\treturn path;\n};\n\nexport const Axis = ({\n\ttype = \"axis\",\n\ttickSize = 6,\n\ttickPadding = 3,\n\tposition,\n\theight,\n\twidth,\n\taxis,\n\tscale,\n\tticks,\n\ttickFormat,\n\tlabel,\n\tlabelX,\n\tlabelY,\n\tname = \"\",\n\tonAxisMount,\n}) => {\n\treturn g => {\n\t\tlet [w, h] = [0, 0];\n\t\tif (position == \"bottom\") h = height;\n\t\tif (position == \"right\")  w = width;\n\n\t\tif (axis == \"x\" && type == \"grid\") {\n\t\t\ttickSize = -height;\n\t\t} else if (axis == \"y\" && type == \"grid\") {\n\t\t\ttickSize = -width;\n\t\t}\n\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\n\t\t\t.scale(scale)\n\t\t\t.ticks(ticks)\n\t\t\t.tickPadding(tickPadding)\n\t\t\t.tickSize(tickSize)\n\t\t\t.tickFormat(tickFormat);\n\n\t\tlet axisGroup = g.append(\"g\")\n\t\t\t.attr(\"class\", [axis, type, position, name].join(\" \"))\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\n\t\t\t.call(axisScale);\n\n\t\tif (label) {\n\t\t\taxisGroup.append(\"svg:text\")\n\t\t\t\t.attr(\"x\", labelX)\n\t\t\t\t.attr(\"y\", labelY)\n\t\t\t\t.text(label);\n\t\t}\n\n\t\tif (onAxisMount) {\n\t\t\taxisGroup.call(onAxisMount);\n\t\t}\n\n\t\treturn axisGroup;\n\t};\n};\n\nexport const Grid = (props) => {\n\tprops.type = \"grid\";\n\treturn Axis(props);\n};\n\nexport const PositionMarker = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlabels = {},\n\titem = {},\n\tlength = 0,\n}) => {\n\treturn g => {\n\n\t\tg.attr(\"class\", \"height-focus-group\");\n\n\t\tlet line   = g.select('.height-focus.line');\n\t\tlet circle = g.select('.height-focus.circle-lower');\n\t\tlet text   = g.select('.height-focus-label');\n\n\t\tif (!line.node()) line = g.append('svg:line');\n\t\tif (!circle.node()) circle = g.append('svg:circle');\n\t\tif (!text.node()) text = g.append('svg:text');\n\n\t\tif (isNaN(xCoord) || isNaN(yCoord)) return g;\n\n\t\tcircle\n\t\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\n\t\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\n\t\t\t.attr(\"r\", 6)\n\t\t\t.attr(\"cx\", 0)\n\t\t\t.attr(\"cy\", 0);\n\n\t\tline\n\t\t\t.attr(\"class\", theme + \" height-focus line\")\n\t\t\t.attr(\"x1\", xCoord)\n\t\t\t.attr(\"x2\", xCoord)\n\t\t\t.attr(\"y1\", yCoord)\n\t\t\t.attr(\"y2\", length);\n\n\t\ttext\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\n\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t.attr(\"x\", xCoord + 5)\n\t\t\t.attr(\"y\", length);\n\n\t\tlet label;\n\n\t\tObject\n\t\t.keys(labels)\n\t\t.sort((a, b) => labels[a].order - labels[b].order) // TODO: any performance issues?\n\t\t.forEach((i)=> {\n\t\t\tlabel = text.select(\".height-focus-\" + labels[i].name);\n\n\t\t\tif (!label.size()) {\n\t\t\t\tlabel = text.append(\"svg:tspan\")\n\t\t\t\t\t.attr(\"class\", \"height-focus-\" + labels[i].name)\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t}\n\n\t\t\tlabel.text(typeof labels[i].value !== \"function\" ? labels[i].value : labels[i].value(item));\n\n\t\t});\n\n\t\ttext.select('tspan').attr(\"dy\", text.selectAll('tspan').size() > 1 ? \"-1.5em\" : \"0em\" );\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\n\n\t\treturn g;\n\t}\n};\n\nexport const LegendItem = ({\n\tname,\n\tlabel,\n\twidth,\n\theight,\n\tmargins = {},\n\tcolor,\n\tpath\n}) => {\n\treturn g => {\n\t\tg\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\n\t\t\t.attr(\"data-name\", name);\n\n\t\tg.on('click.legend', () => d3.select(g.node().ownerSVGElement || g)\n\t\t\t.dispatch(\"legend_clicked\", {\n\t\t\t\tdetail: {\n\t\t\t\t\tpath: path.node(),\n\t\t\t\t\tname: name,\n\t\t\t\t\tlegend: g.node(),\n\t\t\t\t\tenabled: !path.classed('leaflet-hidden'),\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\n\t\tg.append(\"svg:rect\")\n\t\t\t.attr(\"x\", (width / 2) - 50)\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\n\t\t\t.attr(\"width\", 50)\n\t\t\t.attr(\"height\", 10)\n\t\t\t.attr(\"fill\", color)\n\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\n\t\tg.append('svg:text')\n\t\t\t.text(L._(label || name))\n\t\t\t.attr(\"x\", (width / 2) + 5)\n\t\t\t.attr(\"font-size\", 10)\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr('y', height + margins.bottom / 2)\n\t\t\t.attr('dy', \"0.75em\");\n\n\t\treturn g;\n\t}\n};\n\nexport const Tooltip = ({\n\txCoord,\n\tyCoord,\n\twidth,\n\theight,\n\tlabels = {},\n\titem = {},\n}) => {\n\treturn g => {\n\n\t\tlet line = g.select('.mouse-focus-line');\n\t\tlet box = g.select('.mouse-focus-label');\n\n\t\tif (!line.node()) line = g.append('svg:line');\n\t\tif (!box.node()) box = g.append(\"g\");\n\n\t\tlet rect = box.select(\".mouse-focus-label-rect\");\n\t\tlet text = box.select(\".mouse-focus-label-text\");\n\n\t\tif (!rect.node()) rect = box.append(\"svg:rect\");\n\t\tif (!text.node()) text = box.append(\"svg:text\");\n\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\n\t\tlet xAlign = 0;\n\t\tlet yAlign = 0;\n\t\tlet bbox   = { width: 0, height: 0 };\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\n\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\n\n\t\tline\n\t\t\t.attr('class', 'mouse-focus-line')\n\t\t\t.attr('x2', xCoord)\n\t\t\t.attr('y2', 0)\n\t\t\t.attr('x1', xCoord)\n\t\t\t.attr('y1', height);\n\n\t\tbox\n\t\t\t.attr('class', 'mouse-focus-label');\n\n\t\trect\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\n\t\t\t.attr(\"x\", xAlign - 5)\n\t\t\t.attr(\"y\", yAlign - 5)\n\t\t\t.attr(\"width\", bbox.width + 10)\n\t\t\t.attr(\"height\", bbox.height + 10)\n\t\t\t.attr(\"rx\", 3)\n\t\t\t.attr(\"ry\", 3);\n\n\t\ttext\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr(\"y\", yAlign);\n\n\t\tlet label;\n\n\t\tObject\n\t\t\t.keys(labels)\n\t\t\t.sort((a, b) => labels[a].order - labels[b].order) // TODO: any performance issues?\n\t\t\t.forEach((i)=> {\n\t\t\t\tlabel = text.select(\".mouse-focus-label-\" + labels[i].name);\n\n\t\t\t\tif (!label.size()) {\n\t\t\t\t\tlabel = text.append(\"svg:tspan\", \".mouse-focus-label-x\")\n\t\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-\" + labels[i].name)\n\t\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t\t}\n\n\t\t\t\tlabel.text(typeof labels[i].value !== \"function\" ? labels[i].value : labels[i].value(item));\n\t\t\t});\n\n\t\ttext.select('tspan').attr(\"dy\", \"1em\");\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\n\n\t\treturn g;\n\t};\n};\n\nexport const Ruler = ({\n\theight,\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.data([{\n\t\t\t\t\"x\": 0,\n\t\t\t\t\"y\": height,\n\t\t\t}])\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\");\n\n\t\tlet rect   = g.selectAll('.horizontal-drag-rect')\n\t\t\t.data([{ w: width }]);\n\n\t\tlet line   = g.selectAll('.horizontal-drag-line')\n\t\t\t.data([{ w: width }]);\n\n\t\tlet label  = g.selectAll('.horizontal-drag-label')\n\t\t\t.data([{ w: width - 8 }]);\n\n\t\tlet symbol = g.selectAll('.horizontal-drag-symbol')\n\t\t\t.data([{\n\t\t\t\t\"type\": d3.symbolTriangle,\n\t\t\t\t\"x\": width + 7,\n\t\t\t\t\"y\": 0,\n\t\t\t\t\"angle\": -90,\n\t\t\t\t\"size\": 50\n\t\t\t}]);\n\n\t\trect.exit().remove();\n\t\tline.exit().remove();\n\t\tlabel.exit().remove();\n\t\tsymbol.exit().remove();\n\n\t\trect.enter()\n\t\t\t.append(\"svg:rect\")\n\t\t\t.attr(\"class\", \"horizontal-drag-rect\")\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"y\", -8)\n\t\t\t.attr(\"height\", 8)\n\t\t\t.attr('fill', 'none')\n\t\t\t.attr('pointer-events', 'all')\n\t\t\t.merge(rect)\n\t\t\t.attr(\"width\", d => d.w);\n\n\t\tline.enter()\n\t\t\t.append(\"svg:line\")\n\t\t\t.attr(\"class\", \"horizontal-drag-line\")\n\t\t\t.attr(\"x1\", 0)\n\t\t\t.merge(line)\n\t\t\t.attr(\"x2\", d => d.w);\n\n\t\tlabel.enter()\n\t\t\t.append(\"svg:text\")\n\t\t\t.attr(\"class\", \"horizontal-drag-label\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"y\", -8)\n\t\t\t.merge(label)\n\t\t\t.attr(\"x\", d => d.w)\n\n\t\tsymbol\n\t\t\t.enter()\n\t\t\t.append(\"svg:path\")\n\t\t\t.attr(\"class\", \"horizontal-drag-symbol\")\n\t\t\t.merge(symbol)\n\t\t\t.attr(\"d\",\n\t\t\t\td3.symbol()\n\t\t\t\t.type(d => d.type)\n\t\t\t\t.size(d => d.size)\n\t\t\t)\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \") rotate(\" + d.angle + \")\");\n\n\t\treturn g;\n\t}\n};\n\nexport const CheckPoint = ({\n\tpoint,\n\theight,\n\twidth,\n\tx,\n\ty\n}) => {\n\treturn g => {\n\n\t\tif (isNaN(x) || isNaN(y)) return g;\n\n\t\tif (!point.item || !point.item.property('isConnected')) {\n\t\t\tpoint.position = point.position || \"bottom\";\n\n\t\t\tpoint.item = g.append('g');\n\n\t\t\tpoint.item.append(\"svg:line\")\n\t\t\t\t.attr(\"y1\", 0)\n\t\t\t\t.attr(\"x1\", 0)\n\t\t\t\t.attr(\"style\",\"stroke: rgb(51, 51, 51); stroke-width: 0.5; stroke-dasharray: 2, 2;\");\n\n\t\t\tpoint.item\n\t\t\t\t.append(\"svg:circle\")\n\t\t\t\t.attr(\"class\", \" height-focus circle-lower\")\n\t\t\t\t.attr(\"r\", 3);\n\n\t\t\tif (point.label) {\n\t\t\t\tpoint.item.append(\"svg:text\")\n\t\t\t\t\t.attr(\"dx\", \"4px\")\n\t\t\t\t\t.attr(\"dy\", \"-4px\");\n\t\t\t}\n\t\t}\n\n\t\tpoint.item\n\t\t\t.datum({\n\t\t\t\tpos: point.position,\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t})\n\t\t\t.attr(\"class\", d => \"point \" + d.pos)\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\");\n\n\t\tpoint.item.select('line')\n\t\t\t.datum({\n\t\t\t\ty2: ({'top': -y, 'bottom': height - y})[point.position],\n\t\t\t\tx2: ({'left': -x, 'right': width - x})[point.position] || 0\n\t\t\t})\n\t\t\t.attr(\"y2\", d => d.y2)\n\t\t\t.attr(\"x2\", d => d.x2)\n\n\t\tif (point.label) {\n\t\t\tpoint.item.select('text')\n\t\t\t\t.text(point.label);\n\t\t}\n\n\t\treturn g;\n\t}\n};\n\nexport const Domain = ({\n\tmin,\n\tmax,\n\tattr,\n\tname,\n\tforceBounds,\n\tscale\n}) => function(data) {\n\tattr = attr || name;\n\tif (scale && scale.attr) attr = scale.attr;\n\tlet domain = data && data.length ? d3.extent(data, d => d[attr]) : [0, 1];\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\n\t\tdomain[0] = min;\n\t}\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\n\t\tdomain[1] = max;\n\t}\n\treturn domain;\n};\n\nexport const Range = ({\n\taxis\n}) => function(width, height) {\n\tif (axis == 'x')      return [0, width];\n\telse if (axis == 'y') return [height, 0];\n};\n\nexport const Scale = ({\n\tdata,\n\tattr,\n\tmin,\n\tmax,\n\tforceBounds,\n\trange,\n}) => {\n\treturn d3.scaleLinear()\n\t\t.range(range)\n\t\t.domain(Domain({min, max, attr, forceBounds})(data));\n};\n\nexport const Bisect = ({\n\tdata = [0, 1],\n\tscale,\n\tx,\n\tattr\n}) => {\n\treturn d3\n\t\t.bisector(d => d[attr])\n\t\t.left(data, scale.invert(x));\n};\n\nexport const Chart = ({\n\twidth,\n\theight,\n\tmargins = {},\n\truler,\n}) => {\n\n\tconst _width   = width - margins.left - margins.right;\n\tconst _height  = height - margins.top - margins.bottom;\n\n\t// SVG Container\n\tconst svg   = d3.create(\"svg:svg\").attr(\"class\", \"background\");\n\n\t// SVG Groups\n\tconst g     = svg.append(\"g\");\n\tconst panes = {\n\t\tgrid   : g.append(\"g\").attr(\"class\", \"grid\"),\n\t\tarea   : g.append('g').attr(\"class\", \"area\"),\n\t\taxis   : g.append('g').attr(\"class\", \"axis\"),\n\t\tpoint  : g.append('g').attr(\"class\", \"point\"),\n\t\tbrush  : g.append(\"g\").attr(\"class\", \"brush\"),\n\t\ttooltip: g.append(\"g\").attr(\"class\", \"tooltip\").attr('display', 'none'),\n\t\truler  : g.append('g').attr('class', 'ruler'),\n\t\tlegend : g.append('g').attr(\"class\", \"legend\"),\n\t};\n\n\t// SVG Paths\n\tconst mask          = panes.area.append(\"svg:mask\").attr(\"id\", 'elevation-clipper').attr('fill-opacity', 1);\n\tconst maskRect      = mask.append(\"svg:rect\").attr('class', 'zoom').attr('fill', 'white'); // white = transparent\n\n\t// Canvas Paths\n\tconst foreignObject = panes.area.append('svg:foreignObject').attr('mask', 'url(#' + mask.attr('id') + ')');\n\tconst canvas        = foreignObject.append('xhtml:canvas').attr('class', 'canvas-plot');\n\tconst context       = canvas.node().getContext('2d');\n\n\t// Add tooltip\n\tpanes.tooltip.call(Tooltip({ xCoord: 0, yCoord: 0, height: _height, width : _width, labels: {} }));\n\n\t// Add the brushing\n\tlet brush   = d3.brushX().on('start.cursor end.cursor brush.cursor', () => panes.brush.select(\".overlay\").attr('cursor', null));\n\n\t// Scales\n\tconst scale = (opts) => ({ x: Scale(opts.x), y: Scale(opts.y)});\n\n\tlet utils = {\n\t\tmask,\n\t\tcanvas,\n\t\tcontext,\n\t\tbrush,\n\t};\n\n\tlet chart = {\n\t\tsvg,\n\t\tg,\n\t\tpanes,\n\t\tutils,\n\t\tscale,\n\t};\n\n\t// Resize\n\tchart._resize  = ({\n\t\twidth,\n\t\theight,\n\t\tmargins = {},\n\t\truler,\n\t}) => {\n\n\t\tconst _width   = width - margins.left - margins.right;\n\t\tconst _height  = height - margins.top - margins.bottom;\n\n\t\tsvg.attr(\"viewBox\", `0 0 ${width} ${height}`)\n\t\t\t.attr(\"width\", width)\n\t\t\t.attr(\"height\", height);\n\n\t\tg.attr(\"transform\", \"translate(\" + margins.left + \",\" + margins.top + \")\");\n\n\t\t// Partially fix: https://github.com/Raruto/leaflet-elevation/issues/123\n\t\tif(/Mac|iPod|iPhone|iPad/.test(navigator.platform) && /AppleWebkit/i.test(navigator.userAgent)) {\n\t\t\tcanvas\n\t\t\t.style(\"transform\", \"translate(\" + margins.left + \"px,\" + margins.top + \"px)\");\n\t\t}\n\n\t\tmaskRect\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"y\", 0)\n\t\t\t.attr(\"width\", _width)\n\t\t\t.attr(\"height\", _height);\n\n\t\tforeignObject\n\t\t\t.attr('width', _width)\n\t\t\t.attr('height', _height);\n\n\t\tcanvas\n\t\t\t.attr('width', _width)\n\t\t\t.attr('height', _height);\n\n\t\tif (ruler) {\n\t\t\tpanes.ruler.call(Ruler({ height: _height, width: _width }));\n\t\t}\n\n\t\tpanes.brush.call(brush.extent( [ [0,0], [_width, _height] ] ));\n\t\tpanes.brush.select(\".overlay\").attr('cursor', null);\n\n\t\tchart._width  = _width;\n\t\tchart._height = _height;\n\n\t\tchart.svg.dispatch('resize', { detail: { width: _width, height: _height } } );\n\n\t};\n\n\tchart.pane = (name) => {\n\t\tif (!panes[name]) {\n\t\t\tpanes[name] = g.append('g').attr(\"class\", name);\n\t\t}\n\t\treturn panes[name];\n\t}\n\n\tchart.get = (name) => utils[name];\n\n\tchart._resize({ width, height, margins});\n\n\treturn chart;\n};\n","import 'leaflet-i18n';\nimport * as _  from './utils';\nimport * as D3 from './components';\n\nexport var Chart = L.Class.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\tinitialize: function(opts, control) {\n\t\tthis.options       = opts;\n\t\tthis.control       = control;\n\n\t\tthis._data         = [];\n\n\t\t// cache registered components\n\t\tthis._props        = {\n\t\t\tscales      : {},\n\t\t\tpaths       : {},\n\t\t\tareas       : {},\n\t\t\tgrids       : {},\n\t\t\taxes        : {},\n\t\t\tlegendItems : {},\n\t\t\ttooltipItems: {},\n\t\t};\n\n\t\tthis._scales       = {};\n\t\tthis._domains      = {};\n\t\tthis._ranges       = {};\n\t\tthis._paths        = {};\n\n\t\tthis._brushEnabled = opts.dragging;\n\t\tthis._zoomEnabled  = opts.zooming;\n\n\t\tlet chart       = this._chart = D3.Chart(opts);\n\n\t\t// SVG Container\n\t\tlet svg         = this._container = chart.svg;\n\n\t\t// Panes\n\t\tthis._grid      = chart.pane('grid');\n\t\tthis._area      = chart.pane('area');\n\t\tthis._point     = chart.pane('point');\n\t\tthis._axis      = chart.pane('axis');\n\t\tthis._legend    = chart.pane('legend');\n\t\tthis._tooltip   = chart.pane('tooltip');\n\t\tthis._ruler     = chart.pane('ruler');\n\n\t\t// Scales\n\t\tthis._initScale();\n\n\t\t// Helpers\n\t\tthis._mask  = chart.get('mask');\n\t\tthis._context   = chart.get('context');\n\t\tthis._brush     = chart.get('brush');\n\n\t\tthis._zoom = d3.zoom();\n\t\tthis._drag = d3.drag();\n\n\t\t// Interactions\n\t\tthis._initInteractions();\n\n\t\t// svg.on('resize', (e)=>console.log(e.detail));\n\n\t\t// Handle multi-track segments (BETA)\n\t\tthis._maskGaps = [];\n\t\tcontrol.on('eletrack_added', (e) => {\n\t\t\tthis._maskGaps.push(e.index);\n\t\t\tcontrol.once('eledata_updated', (e) => this._maskGaps.push(e.index));\n\t\t});\n\n\t},\n\n\tupdate: function(props) {\n\t\tif (props) {\n\t\t\tif (props.data) this._data = props.data;\n\t\t\tif (props.options) this.options = props.options;\n\t\t}\n\n\t\tthis._updateScale();\n\t\tthis._updateArea();\n\t\tthis._updateAxis();\n\t\tthis._updateLegend();\n\t\tthis._updateClipper();\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._container.node());\n\t},\n\n\tclear: function() {\n\t\tthis._resetDrag();\n\t\tthis._hideDiagramIndicator()\n\t\tthis._area.selectAll('path').attr(\"d\", \"M0 0\");\n\t\tthis._context.clearRect(0, 0, this._width(), this._height());\n\n\t\t// if (this._path) {\n\t\t\t// this._x.domain([0, 1]);\n\t\t\t// this._y.domain([0, 1]);\n\t\t// }\n\n\t\tthis._maskGaps = [];\n\t\tthis._mask.selectAll(\".gap\").remove();\n\t},\n\n\t_drawPath: function(name) {\n\t\tlet path   = this._paths[name];\n\t\tlet area   = this._props.areas[name];\n\n\t\tpath.datum(this._data).attr(\"d\",\n\t\t\tD3.Area(\n\t\t\t\tL.extend({}, area, {\n\t\t\t\t\twidth        : this._width(),\n\t\t\t\t\theight       : this._height(),\n\t\t\t\t\tscaleX       : this._scales[area.scaleX],\n\t\t\t\t\tscaleY       : this._scales[area.scaleY]\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\n\t\tif (path.classed('leaflet-hidden')) return;\n\n\t\tif (this.options.preferCanvas) {\n\t\t\t_.drawCanvas(this._context, path);\n\t\t} else {\n\t\t\tthis._area.append(() => path.node());\n\t\t}\n\t},\n\n\t_hasActiveLayers: function() {\n\t\tconst paths = this._paths;\n\t\tfor (var i in paths) {\n\t\t\tif (!paths[i].classed('leaflet-hidden')) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Initialize \"d3-brush\".\n\t */\n\t_initBrush: function(e) {\n\t\tconst brush   = (e) => {\n\t\t\tif (!this._data.length) return;\n\t\t\tlet extent  = e.selection;\n\t\t\tif (extent) {\n\t\t\t\tlet start = this._findIndexForXCoord(extent[0]);\n\t\t\t\tlet end   = this._findIndexForXCoord(extent[1]);\n\t\t\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\n\t\t\t}\n\t\t}\n\n\t\tconst focus   = (e) => {\n\t\t\tif (!this._data.length) return;\n\t\t\tif (e.type == 'brush' && !e.sourceEvent) return;\n\t\t\tlet rect    = this._chart.panes.brush.select('.overlay').node();\n\t\t\tlet coords  = d3.pointers(e, rect)[0];\n\t\t\tlet xCoord  = coords[0];\n\t\t\tlet item    = this._data[this._findIndexForXCoord(xCoord)];\n\n\t\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\n\t\t};\n\n\t\tthis._brush\n\t\t\t.filter((e) => this._brushEnabled && !e.shiftKey && !e.button)\n\t\t\t.on(\"end.update\", brush)\n\t\t\t.on(\"brush.update\", focus);\n\n\t\tthis._chart.panes.brush\n\t\t\t.on(\"mouseenter.focus touchstart.focus\", this.fire.bind(this, \"mouse_enter\"))\n\t\t\t.on(\"mouseout.focus touchend.focus\",     this.fire.bind(this, \"mouse_out\")  )\n\t\t\t.on(\"mousemove.focus touchmove.focus\",   focus                              );\n\n\t},\n\n\t/**\n\t * Initialize \"d3-zoom\"\n\t */\n\t_initClipper: function() {\n\t\tlet svg       = this._container;\n\t\tlet margin    = this.options.margins;\n\n\t\tconst zoom    = this._zoom;\n\n\t\tconst onStart = (e) => {\n\t\t\tif (e.sourceEvent && e.sourceEvent.type == \"mousedown\") svg.style('cursor', 'grabbing');\n\t\t\tif (e.transform.k == 1 && e.transform.x == 0) {\n\t\t\t\tthis._container.classed('zoomed', true);\n\t\t\t\t// Apply d3-zoom (bind <clipPath> mask)\n\t\t\t\tif (this._mask) {\n\t\t\t\t\tthis._point.attr('mask', 'url(#' + this._mask.attr('id') + ')');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.zooming = true;\n\t\t};\n\n\t\tconst onEnd  = (e) => {\n\t\t\tif (e.transform.k ==1 && e.transform.x == 0){\n\t\t\t\tthis._container.classed('zoomed', false);\n\t\t\t\t// Apply d3-zoom (bind <clipPath> mask)\n\t\t\t\tif (this._mask) {\n\t\t\t\t\tthis._point.attr('mask', null);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.zooming = false;\n\t\t\tsvg.style('cursor', '');\n\t\t};\n\n\t\tconst onZoom = (e) => {\n\t\t\t// TODO: find a faster way to redraw the chart.\n\t\t\tthis.zooming = false;\n\t\t\tthis._updateScale(); // hacky way for restoring x scale when zooming out\n\t\t\tthis.zooming = true;\n\t\t\tthis._scales.distance = this._x = e.transform.rescaleX(this._x); // calculate x scale at zoom level\n\t\t\tif (this._scales.time) this._scales.time = e.transform.rescaleX(this._scales.time); // calculate x scale at zoom level\n\t\t\tthis._resetDrag();\n\t\t\tif (e.sourceEvent && e.sourceEvent.type == \"mousemove\") {\n\t\t\t\tthis._hideDiagramIndicator();\n\t\t\t}\n\t\t\tthis.fire('zoom');\n\t\t};\n\n\t\tzoom\n\t\t\t.scaleExtent([1, 10])\n\t\t\t.extent([\n\t\t\t\t[margin.left, 0],\n\t\t\t\t[this._width() - margin.right, this._height()]\n\t\t\t])\n\t\t\t.translateExtent([\n\t\t\t\t[margin.left, -Infinity],\n\t\t\t\t[this._width() - margin.right, Infinity]\n\t\t\t])\n\t\t\t.filter((e) => this._zoomEnabled && (e.shiftKey || e.buttons == 4))\n\t\t\t.on(\"start\", onStart)\n\t\t\t.on(\"end\", onEnd)\n\t\t\t.on(\"zoom\", onZoom);\n\n\t\tsvg.call(zoom); // add zoom functionality to \"svg\" group\n\n\t\t// d3.select(\"body\").on(\"keydown.grabzoom keyup.grabzoom\", (e) => svg.style('cursor', e.shiftKey ? 'move' : ''));\n\n\t},\n\n\t_initInteractions: function() {\n\t\tthis._initBrush();\n\t\tthis._initRuler();\n\t\tthis._initClipper();\n\t\tthis._initLegend();\n\t},\n\n\t/**\n\t * Toggle chart data on legend click\n\t */\n\t_initLegend: function() {\n\t\tthis._container.on('legend_clicked', (e) => {\n\t\t\tlet { path, legend, name, enabled } = e.detail;\n\n\t\t\tif (!path) return;\n\n\t\t\tlet label = _.select('text', legend);\n\t\t\tlet rect  = _.select('rect', legend);\n\n\t\t\t_.toggleStyle(label, 'text-decoration-line', 'line-through', enabled);\n\t\t\t_.toggleStyle(rect,  'fill-opacity',         '0',            enabled);\n\t\t\t_.toggleClass(path,  'leaflet-hidden',                       enabled);\n\n\t\t\tthis._updateArea();\n\n\t\t\tthis.fire(\"elepath_toggle\", { path, name, legend, enabled })\n\t\t});\n\t},\n\n\t/**\n\t * Initialize \"ruler\".\n\t */\n\t_initRuler: function() {\n\t\tif (!this.options.ruler) return;\n\n\t\t// const yMax      = this._height();\n\t\tconst formatNum = d3.format(\".0f\");\n\t\tconst drag      = this._drag;\n\n\t\tconst label     = (e, d) => {\n\t\t\tlet yMax      = this._height();\n\t\t\tlet y         = this._ruler.data()[0].y;\n\t\t\tif (y >= yMax || y <= 0) this._ruler.select(\".horizontal-drag-label\").text('');\n\t\t\tthis._hideDiagramIndicator();\n\t\t};\n\n\t\tconst position  = (e, d) => {\n\t\t\tlet yMax      = this._height();\n\t\t\tlet yCoord    = d3.pointers(e, this._area.node())[0][1];\n\t\t\tlet y         = yCoord > 0 ? (yCoord < yMax ? yCoord : yMax) : 0;\n\t\t\tlet z         = this._y.invert(y);\n\t\t\tlet data      = L.extend(this._ruler.data()[0], { y: y });\n\n\t\t\tthis._ruler\n\t\t\t\t.data([data])\n\t\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\")\n\t\t\t\t.classed('active', y < yMax);\n\n\t\t\tthis._container.select(\".horizontal-drag-label\")\n\t\t\t\t.text(formatNum(z) + \" \" + (this.options.imperial ? 'ft' : 'm'));\n\n\t\t\tthis.fire('ruler_filter', { coords: yCoord < yMax && yCoord > 0 ? this._findCoordsForY(yCoord) : [] });\n\t\t}\n\n\t\tdrag\n\t\t.on(\"start end\", label)\n\t\t.on(\"drag\", position);\n\n\t\tthis._ruler.call(drag);\n\n\t},\n\n\t/**\n\t * Initialize x and y scales\n\t */\n\t_initScale: function() {\n\t\tlet opts = this.options;\n\n\t\tthis._registerAxisScale({\n\t\t\taxis    : 'x',\n\t\t\tposition: 'bottom',\n\t\t\tattr    : opts.xAttr,\n\t\t\tmin     : opts.xAxisMin,\n\t\t\tmax     : opts.xAxisMax,\n\t\t\tname    : 'distance'\n\t\t});\n\n\t\tthis._registerAxisScale({\n\t\t\taxis     : 'y',\n\t\t\tposition : 'left',\n\t\t\tattr     : opts.yAttr,\n\t\t\tmin      : opts.yAxisMin,\n\t\t\tmax      : opts.yAxisMax,\n\t\t\tname     : 'altitude'\n\t\t});\n\n\t\tthis._x = this._scales.distance;\n\t\tthis._y = this._scales.altitude;\n\t},\n\n\t_registerAreaPath: function(props) {\n\t\tif (props.scale == 'y') props.scale = this._y;\n\t\telse if (props.scale == 'x') props.scale = this._x;\n\n\t\tlet opts = this.options;\n\n\t\tif (!props.xAttr) props.xAttr = opts.xAttr;\n\t\tif (!props.yAttr) props.yAttr = opts.yAttr;\n\t\tif (typeof props.preferCanvas === \"undefined\") props.preferCanvas = opts.preferCanvas;\n\n\t\tlet path = D3.Path(props);\n\n\t\t// Save paths in memory for latter usage\n\t\tthis._paths[props.name]       = path;\n\t\tthis._props.areas[props.name] = props;\n\n\t\tif (opts.legend) {\n\t\t\tthis._props.legendItems[props.name] = {\n\t\t\t\tname   : props.name,\n\t\t\t\tlabel  : props.label,\n\t\t\t\tcolor  : props.color,\n\t\t\t\tpath   : path\n\t\t\t};\n\t\t}\n\n\t},\n\n\t_registerAxisGrid: function(props) {\n\t\tif (props.scale == 'y') props.scale = this._y;\n\t\telse if(props.scale == 'x') props.scale = this._x;\n\n\t\tthis._props.grids[props.name || props.axis] = props;\n\t},\n\n\t_registerAxisScale: function(props) {\n\t\tif (props.scale == 'y') props.scale = this._y;\n\t\telse if(props.scale == 'x') props.scale = this._x;\n\n\t\tlet opts  = this.options;\n\t\tlet scale = props.scale;\n\n\t\tif (typeof this._scales[props.name] === 'function') {\n\t\t\tprops.scale = this._scales[props.name]; // retrieve cached scale\n\t\t} else if (typeof scale !== 'function') {\n\t\t\tscale       = L.extend({\n\t\t\t\tdata       : this._data,\n\t\t\t\tforceBounds: opts.forceAxisBounds\n\t\t\t}, scale);\n\n\t\t\tscale.attr   = scale.attr || props.name;\n\n\t\t\tlet domain   = this._domains[props.name] = D3.Domain(props);\n\t\t\tlet range    = this._ranges[props.name]  = D3.Range(props);\n\t\t\tscale.range  = scale.range  || range(this._width(),this._height());\n\t\t\tscale.domain = scale.domain || domain(this._data);\n\n\t\t\tthis._props.scales[props.name] = scale;\n\n\t\t\tprops.scale = this._scales[props.name] = D3.Scale(scale);\n\t\t}\n\n\t\tif (!props.ticks) {\n\t\t\tif (props.axis == 'x')      props.ticks = opts.xTicks;\n\t\t\telse if (props.axis == 'y') props.ticks = opts.yTicks;\n\t\t}\n\n\t\tthis._props.axes[props.name] = props;\n\n\t\treturn scale;\n\t},\n\n\t/**\n\t * Add a point of interest over the chart\n\t */\n\t_registerCheckPoint: function(point) {\n\t\tif (!this._data.length) return;\n\n\t\tlet item, x, y;\n\n\t\tif (point.latlng) {\n\t\t\titem = this._data[this._findIndexForLatLng(point.latlng)];\n\t\t\tx    = this._x(item.dist);\n\t\t\ty    = this._y(item.z);\n\t\t} else if (!isNaN(point.dist)) {\n\t\t\tx    = this._x(point.dist);\n\t\t\titem = this._data[this._findIndexForXCoord(x)]\n\t\t\ty    = this._y(item.z);\n\t\t} \n\n\t\tthis._point.call(D3.CheckPoint({\n\t\t\tpoint: point,\n\t\t\twidth: this._width(),\n\t\t\theight: this._height(),\n\t\t\tx: x,\n\t\t\ty: y,\n\t\t}));\n\t},\n\n\t_registerTooltip: function(props) {\n\t\tprops.order = props.order ?? 100;\n\t\tthis._props.tooltipItems[props.name] = props;\n\t},\n\n\t_updateArea: function() {\n\t\tlet paths = this._paths;\n\t\t// Reset and update chart profiles\n\t\tthis._context.clearRect(0, 0, this._width(), this._height());\n\t\tfor (var i in paths) {\n\t\t\tif (!paths[i].classed('leaflet-hidden')) {\n\t\t\t\tthis._drawPath(i);\n\t\t\t}\n\t\t}\n\t},\n\n\t_updateAxis: function() {\n\n\t\tlet opts = this.options;\n\n\t\t// Reset chart axis.\n\t\tthis._grid.selectAll('g').remove();\n\t\tthis._axis.selectAll('g').remove();\n\n\t\tlet grids = this._props.grids;\n\t\tlet axes  = this._props.axes;\n\t\tlet props, axis, grid;\n\n\t\tlet gridOpts = {\n\t\t\twidth     : this._width(),\n\t\t\theight    : this._height(),\n\t\t\ttickFormat: \"\",\n\t\t};\n\t\tlet axesOpts  = {\n\t\t\twidth  : this._width(),\n\t\t\theight : this._height(),\n\t\t};\n\n\t\t// Render grids\n\t\tfor (let i in grids) {\n\t\t\tprops = L.extend({}, gridOpts, grids[i]);\n\t\t\tgrid  = D3.Grid(props);\n\t\t\tthis._grid.call(grid);\n\t\t}\n\n\t\t// Render axis\n\t\tfor (let i in axes) {\n\t\t\tif (opts[i] === false || opts[i] === 'summary') continue;\n\t\t\tprops = L.extend({}, axesOpts, axes[i]);\n\t\t\taxis  = D3.Axis(props);\n\t\t\tthis._axis.call(axis);\n\t\t}\n\n\t\t// Adjust axis scale positions\n\t\tthis._axis\n\t\t\t.selectAll('.y.axis.right')\n\t\t\t.each((d, i, n) => {\n\n\t\t\t\tlet axis      = d3.select(n[i]);\n\t\t\t\tlet transform = axis.attr('transform');\n\t\t\t\tlet translate = transform.substring(transform.indexOf(\"(\") + 1, transform.indexOf(\")\")).split(\",\");\n\n\t\t\t\taxis.attr('transform', 'translate(' + (+translate[0] + (i * 40)) + ',' + translate[1] + ')')\n\n\t\t\t\tif (i > 0) {\n\t\t\t\t\taxis.select(':scope > path')         .attr('opacity', 0.25);\n\t\t\t\t\taxis.selectAll(':scope > .tick line').attr('opacity', 0.75);\n\t\t\t\t}\n\n\t\t\t});\n\n\t},\n\n\t_updateClipper: function() {\n\t\tlet margin = this.options.margins;\n\n\t\tthis._zoom\n\t\t\t.scaleExtent([1, 10])\n\t\t\t.extent([\n\t\t\t\t[margin.left, 0],\n\t\t\t\t[this._width() - margin.right, this._height()]\n\t\t\t])\n\t\t\t.translateExtent([\n\t\t\t\t[margin.left, -Infinity],\n\t\t\t\t[this._width() - margin.right, Infinity]\n\t\t\t]);\n\n\t\t// Apply svg mask on multi-track segments (BETA)\n\t\tthis._mask.selectAll(\".gap\").remove()\n\t\tthis._maskGaps.forEach((d, i) => {\n\t\t\tif(i >= this._maskGaps.length - 2) return;\n\t\t\tlet d1 = this._data[this._maskGaps[i]];\n\t\t\tlet d2 = this._data[this._maskGaps[i + 1]];\n\t\t\tlet x1 = this._x(this._data[this._findIndexForLatLng(d1.latlng)].dist);\n\t\t\tlet x2 = this._x(this._data[this._findIndexForLatLng(d2.latlng)].dist);\n\t\t\tthis._mask\n\t\t\t\t.append(\"rect\")\n\t\t\t\t.attr(\"x\", x1)\n\t\t\t\t.attr(\"y\", 0)\n\t\t\t\t.attr(\"width\", x2 - x1 )\n\t\t\t\t.attr(\"height\", this._height())\n\t\t\t\t.attr('class', 'gap')\n\t\t\t\t.attr('fill-opacity', '0.8')\n\t\t\t\t.attr(\"fill\", 'black');  // black = hide\n\t\t});\n\t},\n\n\t_updateLegend: function () {\n\n\t\tif (this.options.legend === false) return;\n\n\t\tlet legends = this._props.legendItems;\n\t\tlet legend;\n\n\t\t// Reset legend items\n\t\tthis._legend.selectAll('g').remove();\n\t\tfor (var i in legends) {\n\t\t\tlegend = D3.LegendItem(\n\t\t\t\tL.extend({\n\t\t\t\t\twidth  : this._width(),\n\t\t\t\t\theight : this._height(),\n\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t}, legends[i])\n\t\t\t)\n\t\t\tthis._legend.append(\"g\").call(legend);\n\t\t}\n\n\t\t// Get legend items\n\t\tlet items  = this._legend.selectAll('.legend-item');\n\n\t\t// Calculate legend item positions\n\t\tlet n    = items.nodes().length;\n\t\tlet v      = Array(Math.floor(n / 2)).fill(null).map((d, i) => (i + 1) * 2 - (1 - Math.sign(n % 2)));\n\t\tlet rev    = v.slice().reverse().map((d) => -(d));\n\n\t\tif (n % 2 !== 0) {\n\t\t\trev.push(0);\n\t\t}\n\t\tv = rev.concat(v);\n\n\t\t// Get chart margins\n\t\tlet xAxesB  = this._axis.selectAll('.x.axis.bottom').nodes().length;\n\t\tlet marginB = 30 + (xAxesB * 2);\n\t\tlet marginR = n * 30;\n\n\t\t// Adjust chart right margins\n\t\tif (n && this.options.margins.right < marginR) {\n\t\t\tthis.options.margins.right  = marginR;\n\t\t\tthis.fire('margins_updated');\n\t\t}\n\n\t\t// Adjust chart bottom margins\n\t\tif(xAxesB && this.options.margins.bottom < marginB) {\n\t\t\tthis.options.margins.bottom = marginB;\n\t\t\tthis.fire('margins_updated');\n\t\t}\n\n\t\titems\n\t\t\t.each((d, i, n) => {\n\n\t\t\t\tlet legend  = d3.select(n[i]);\n\t\t\t\tlet rect    = legend.select('rect');\n\t\t\t\tlet name    = legend.attr('data-name');\n\t\t\t\tlet path    = this._paths[name];\n\n\t\t\t\tlet tx      = v[i] * 55;\n\t\t\t\tlet ty      = xAxesB * 2;\n\n\t\t\t\tlegend\n\n\t\t\t\t// Adjust legend item positions\n\t\t\t\t.attr(\"transform\", \"translate(\" + tx + \", \" + ty + \")\");\n\n\t\t\t\t// Set initial state (disabled controls)\n\t\t\t\tif (name in this.options && this.options[name] == 'disabled') {\n\t\t\t\t\tpath.classed('leaflet-hidden', true);\n\t\t\t\t\tlegend.select('text').style('text-decoration-line', 'line-through');\n\t\t\t\t\tlegend.select('rect').style('fill-opacity', '0');\n\t\t\t\t}\n\n\t\t\t\t// Apply d3-zoom (bind <clipPath> mask)\n\t\t\t\tif (this._mask) {\n\t\t\t\t\tpath.attr('mask', 'url(#' + this._mask.attr('id') + ')');\n\t\t\t\t}\n\n\t\t\t});\n\t},\n\n\t_updateScale: function() {\n\t\tif (this.zooming) return { x: this._x, y: this._y };\n\n\t\tfor (let i in this._scales) {\n\t\t\tthis._scales[i]\n\t\t\t\t.domain(this._domains[i](this._data))\n\t\t\t\t.range(this._ranges[i](this._width(), this._height()))\n\t\t}\n\n\t\treturn { x: this._x, y: this._y };\n\t},\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\treturn this._chart._width;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\treturn this._chart._height;\n\t},\n\n\t/*\n\t * Finds data entries above a given y-elevation value and returns geo-coordinates\n\t */\n\t_findCoordsForY: function(y) {\n\t\tlet data = this._data;\n\t\tlet z    = this._y.invert(y);\n\n\t\t// save indexes of elevation values above the horizontal line\n\t\tconst list = data.reduce((array, item, index) => {\n\t\t\tif (item.z >= z) array.push(index);\n\t\t\treturn array;\n\t\t}, []);\n\n\t\tlet start = 0;\n\t\tlet next;\n\n\t\t// split index list into blocks of coordinates\n\t\tconst coords = list.reduce((array, _, curr) => {\n\t\t\tnext = curr + 1;\n\t\t\tif (list[next] !== list[curr] + 1 || next === list.length) {\n\t\t\t\tarray.push(\n\t\t\t\t\tlist\n\t\t\t\t\t.slice(start, next)\n\t\t\t\t\t.map(i => data[i].latlng)\n\t\t\t\t);\n\t\t\t\tstart = next;\n\t\t\t}\n\t\t\treturn array;\n\t\t}, []);\n\n\t\treturn coords;\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findIndexForXCoord: function(x) {\n\t\treturn d3\n\t\t\t.bisector(d => d[this.options.xAttr])\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\n\t},\n\n\t/*\n\t * Finds a data entry for a given latlng of the map\n\t */\n\t_findIndexForLatLng: function(latlng) {\n\t\tlet result = null;\n\t\tlet d      = Infinity;\n\t\tthis._data.forEach((item, index) => {\n\t\t\tlet dist = latlng.distanceTo(item.latlng);\n\t\t\tif (dist < d) {\n\t\t\t\td = dist;\n\t\t\t\tresult = index;\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tif (this._chart.panes.brush.select(\".selection\").attr('width')) {\n\t\t\tthis._chart.panes.brush.call(this._brush.clear);\n\t\t\tthis._hideDiagramIndicator();\n\t\t\tthis.fire('reset_drag');\n\t\t}\n\t},\n\n\t_resetZoom: function() {\n\t\tif (this._zoom) {\n\t\t\tthis._zoom.transform(this._chart.svg, d3.zoomIdentity);\n\t\t}\n\t},\n\n\t/**\n\t * Display distance and altitude level (\"focus-rect\").\n\t */\n\t_showDiagramIndicator: function(item, xCoordinate) {\n\t\tthis._tooltip\n\t\t\t.attr(\"display\", null)\n\t\t\t.call(D3.Tooltip({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\tyCoord: this._y(item[this.options.yAttr]),\n\t\t\t\theight: this._height(),\n\t\t\t\twidth : this._width(),\n\t\t\t\tlabels: this._props.tooltipItems,\n\t\t\t\titem: item\n\t\t\t}));\n\t},\n\n\t_hideDiagramIndicator: function() {\n\t\tthis._tooltip.attr(\"display\", 'none');\n\t},\n});\n","import 'leaflet-i18n';\nimport * as _  from './utils';\nimport * as D3 from './components';\n\nexport var Marker = L.Class.extend({\n\n\tinitialize: function(options) {\n\t\tthis.options = options;\n\n\t\tswitch(this.options.marker) {\n\t\t\tcase 'elevation-line':\n\t\t\t\t// this._container = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\n\t\t\tbreak;\n\t\t\tcase 'position-marker':\n\t\t\t\t// this._marker   = L.circleMarker([0, 0], { pane: 'overlayPane', radius: 6, fillColor: '#fff', fillOpacity:1, color: '#000', weight:1, interactive: false });\n\t\t\t\tthis._marker      = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\n\t\t\tbreak;\n\t\t}\n\n\t\tthis._labels = {};\n\n\t\treturn this;\n\t},\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t\tswitch(this.options.marker) {\n\t\t\tcase 'elevation-line':  this._container = d3.select(map.getPane('elevationPane')).select(\"svg > g\").call(D3.PositionMarker({})); break;\n\t\t\tcase 'position-marker': this._marker.addTo(map, { pane: 'overlayPane' }); break;\n\t\t}\n\t\treturn this;\n\t},\n\n\t/**\n\t * Update position marker (\"leaflet-marker\").\n\t */\n\tupdate: function(props) {\n\t\tif (props) this._props = props;\n\t\telse props = this._props;\n\n\t\tif(!props) return;\n\n\t\tif (props.options) this.options = props.options;\n\t\tif (!this._map) this.addTo(props.map);\n\n\t\tthis._latlng = props.item.latlng;\n\n\t\tswitch(this.options.marker) {\n\t\t\tcase 'elevation-line':\n\t\t\t\tif (this._container) {\n\t\t\t\t\tlet point = this._map.latLngToLayerPoint(this._latlng);\n\t\t\t\t\tpoint     = L.extend({}, props.item, this._map._rotate ? this._map.rotatedPointToMapPanePoint(point) : point);\n\n\t\t\t\t\tthis._container.classed(\"leaflet-hidden\", false);\n\t\t\t\t\tthis._container.call(D3.PositionMarker({\n\t\t\t\t\t\ttheme : this.options.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t\tlength: point.y - (this._height() / props.maxElevation * point.z), // normalized Y\n\t\t\t\t\t\tlabels: this._labels,\n\t\t\t\t\t\titem: point\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\tbreak;\n\t\t\tcase 'position-marker':\n\t\t\t\t_.removeClass(this._marker.getElement(), 'leaflet-hidden');\n\t\t\t\tthis._marker.setLatLng(this._latlng);\n\t\t\tbreak;\n\t\t}\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\tremove: function() {\n\t\tthis._props = null;\n\t\tswitch(this.options.marker) {\n\t\t\tcase 'elevation-line':  this._container && this._container.classed(\"leaflet-hidden\", true); break;\n\t\t\tcase 'position-marker': _.addClass(this._marker.getElement(), 'leaflet-hidden');            break;\n\t\t}\n\t},\n\n\tgetLatLng: function() {\n\t\treturn this._latlng;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t_registerTooltip: function(props) {\n\t\tthis._labels[props.name] = props;\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Summary = L.Class.extend({\n\tinitialize: function(opts, control) {\n\t\tthis.options = opts;\n\t\tthis.control = control;\n\t\tthis.labels = {};\n\n\t\tlet summary = this._container = _.create(\"div\", \"elevation-summary \" + (opts.summary ? opts.summary + \"-summary\" : ''));\n\t\t_.style(summary, 'max-width', opts.width ? opts.width + 'px' : '');\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._container);\n\t},\n\n\treset: function() {\n\t\tthis._container.innerHTML = '';\n\t},\n\n\tappend: function(className, label, value) {\n\t\tthis._container.innerHTML += `<span class=\"${className}\"><span class=\"summarylabel\">${label}</span><span class=\"summaryvalue\">${value}</span></span>`;\n\t\treturn this;\n\t},\n\n\tupdate: function() {\n\t\tObject\n\t\t.keys(this.labels)\n\t\t.sort((a, b) => this.labels[a].order - this.labels[b].order) // TODO: any performance issues?\n\t\t.forEach((i)=> {\n\t\t\tthis.append(i, L._(this.labels[i].label), typeof this.labels[i].value !== \"function\" ? this.labels[i].value : this.labels[i].value(this.control.track_info));\n\t\t});\n\t},\n\n\t_registerSummary: function(data) {\n\t\tfor (let i in data) {\n\t\t\tdata[i].order = data[i].order ?? 100;\n\t\t\tthis.labels[i] = data[i];\n\t\t}\n\t}\n\n});\n","import * as _ from './utils';\n\nexport var Options = {\n\tautofitBounds: true,\n\tautohide: !L.Browser.mobile,\n\tautohideMarker: true,\n\talmostover: true,\n\taltitude: true,\n\tcollapsed: false,\n\tdetached: true,\n\tdistance: true,\n\tdistanceMarkers: {\n\t\tlazy: true,\n\t\tdistance: true,\n\t\tdirection: true\n\t},\n\tdecimalsX: 2,\n\tdecimalsY: 0,\n\tdragging: !L.Browser.mobile,\n\tdownloadLink: 'link',\n\televationDiv: \"#elevation-div\",\n\tfollowMarker: true,\n\tforceAxisBounds: false,\n\theight: 200,\n\timperial: false,\n\tinterpolation: \"curveLinear\",\n\tlazyLoadJS: true,\n\tlegend: true,\n\tmargins: {\n\t\ttop: 30,\n\t\tright: 30,\n\t\tbottom: 30,\n\t\tleft: 40\n\t},\n\tmarker: 'elevation-line',\n\tmarkerIcon: L.divIcon({\n\t\tclassName: 'elevation-position-marker',\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\n\t\ticonSize: [32, 32],\n\t\ticonAnchor: [16, 16],\n\t}),\n\tposition: \"topright\",\n\tpolyline: {\n\t\tclassName: 'elevation-polyline',\n\t\tcolor: '#000',\n\t\topacity: 0.75,\n\t\tweight: 5,\n\t\tlineCap: 'round'\n\t},\n\tpolylineSegments: {\n\t\tclassName: 'elevation-polyline-segments',\n\t\tcolor: '#F00',\n\t\tinteractive: false,\n\t},\n\tpreferCanvas: false,\n\treverseCoords: false,\n\truler: true,\n\tskipNullZCoords: false,\n\ttheme: \"lightblue-theme\",\n\tsummary: 'inline',\n\tslope: false,\n\tslopeDeltaMax: undefined,\n\tslopeRange: undefined,\n\tspeed: false,\n\tspeedDeltaMax: undefined,\n\tspeedRange: undefined,\n\ttime: false,\n\ttimeFactor: 3600,\n\ttimeFormat: false,\n\ttimestamps: false,\n\twidth: 600,\n\twaypoints: true,\n\twptIcons: {\n\t\t'': L.divIcon({\n\t\t\tclassName: 'elevation-waypoint-marker',\n\t\t\thtml: '<i class=\"elevation-waypoint-icon default\"></i>',\n\t\t\ticonSize: [30, 30],\n\t\t\ticonAnchor: [8, 30],\n\t\t}),\n\t},\n\twptLabels: true,\n\txAttr: \"dist\",\n\txLabel: \"km\",\n\txTicks: undefined,\n\tyAttr: \"z\",\n\tyAxisMax: undefined,\n\tyAxisMin: undefined,\n\tyLabel: \"m\",\n\tyTicks: undefined,\n\tzFollow: false,\n\tzooming: !L.Browser.Mobile,\n};\n","import 'leaflet-i18n';\nimport * as _      from './utils';\nimport * as D3     from './components';\nimport { Chart }   from './chart';\nimport { Marker }  from './marker';\nimport { Summary } from './summary';\nimport { Options } from './options';\n\nexport const Elevation = L.Control.Elevation = L.Control.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\toptions: Options,\n\t__mileFactor: 0.621371,\n\t__footFactor: 3.28084,\n\t__D3:          'https://unpkg.com/d3@6.5.0/dist/d3.min.js',\n\t__TOGEOJSON:   'https://unpkg.com/@tmcw/togeojson@4.5.0/dist/togeojson.umd.js',\n\t__LGEOMUTIL:   'https://unpkg.com/leaflet-geometryutil@0.9.3/src/leaflet.geometryutil.js',\n\t__LALMOSTOVER: 'https://unpkg.com/leaflet-almostover@1.0.1/src/leaflet.almostover.js',\n\t__LDISTANCEM:  'https://unpkg.com/@raruto/leaflet-elevation@1.9.6/libs/leaflet-distance-marker.min.js',\n\n\t/*\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\n\t */\n\taddData: function(d, layer) {\n\t\tthis.lazyLoad(this.__D3)\n\t\t\t.then(() => {\n\t\t\t\tif (typeof layer === \"undefined\" && d.on) {\n\t\t\t\t\tlayer = d;\n\t\t\t\t}\n\t\t\t\tthis._addData(d);\n\t\t\t\tthis._addLayer(layer);\n\t\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\n\t\t\t});\n\t},\n\n\t/**\n\t * Adds the control to the given map.\n\t */\n\taddTo: function(map) {\n\t\tif (this.options.detached) {\n\t\t\tlet eleDiv = this._initElevationDiv();\n\t\t\tif (!eleDiv.isConnected) _.insert(map.getContainer(), eleDiv, 'afterend');\n\t\t\t_.append(eleDiv, this.onAdd(map));\n\t\t} else {\n\t\t\tL.Control.prototype.addTo.call(this, map);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/*\n\t * Reset data and display\n\t */\n\tclear: function() {\n\t\tif (this._marker) this._marker.remove();\n\t\tif (this._chart)  this._clearChart();\n\t\tif (this._layers) this._clearLayers();\n\t\tif (this._markers) this._clearMarkers();\n\n\t\tthis._data      = [];\n\t\tthis.track_info = {};\n\n\t\tthis._fireEvt(\"eledata_clear\");\n\n\t\tthis._updateChart();\n\t},\n\n\t_clearChart: function() {\n\t\tif (this._events && this._events.elechart_updated) {\n\t\t\tthis._events.elechart_updated.forEach(e => this.off('elechart_updated', e.fn, e.ctx));\n\t\t}\n\t\tif (this._chart && this._chart._container) {\n\t\t\tthis._chart._container.selectAll('g.point .point').remove();\n\t\t\tthis._chart.clear();\n\t\t}\n\t},\n\n\t_clearLayers: function() {\n\t\tif (this._layers && this._layers.eachLayer) {\n\t\t\tthis._layers.eachLayer(l => l.remove())\n\t\t\tthis._layers.clearLayers();\n\t\t}\n\t},\n\n\t_clearMarkers: function() {\n\t\tif (this._markers && this._markers.eachLayer) {\n\t\t\tthis._markers.eachLayer(l => l.remove())\n\t\t\tthis._markers.clearLayers();\n\t\t}\n\t},\n\n\t/**\n\t * TODO: Create a base class to handle custom data attributes (heart rate, cadence, temperature, ...)\n\t * \n\t * @link https://leafletjs.com/examples/extending/extending-3-controls.html#handlers\n\t */\n\t// addHandler: function (name, HandlerClass) {\n\t// \tif (HandlerClass) {\n\t// \t\tlet handler = this[name] = new HandlerClass(this);\n\t// \t\tthis.handlers.push(handler);\n\t// \t\tif (this.options[name]) {\n\t// \t\t\thandler.enable();\n\t// \t\t}\n\t// \t}\n\t// \treturn this;\n\t// },\n\n\t/**\n\t * Disable chart brushing.\n\t */\n\tdisableBrush: function() {\n\t\tthis._chart._brushEnabled = false;\n\t\tthis._resetDrag();\n\t},\n\n\t/**\n\t * Enable chart brushing.\n\t */\n\tenableBrush: function() {\n\t\tthis._chart._brushEnabled = true;\n\t},\n\n\t/**\n\t * Disable chart zooming.\n\t */\n\tdisableZoom: function() {\n\t\tthis._chart._zoomEnabled = false;\n\t\tthis._chart._resetZoom();\n\t},\n\n\t/**\n\t * Enable chart zooming.\n\t */\n\tenableZoom: function() {\n\t\tthis._chart._zoomEnabled = true;\n\t},\n\n\t/**\n\t * Sets a map view that contains the given geographical bounds.\n\t */\n\tfitBounds: function(bounds) {\n\t\tbounds = bounds || this.getBounds();\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\n\t},\n\n\tgetBounds: function(data) {\n\t\tdata = data || this._data;\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\n\t},\n\n\t/**\n\t * Get default zoom level (followMarker: true).\n\t */\n\tgetZFollow: function() {\n\t\treturn this.options.zFollow;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\thide: function() {\n\t\t_.style(this._container, \"display\", \"none\");\n\t},\n\n\t/**\n\t * Initialize chart control \"options\" and \"container\".\n\t */\n\tinitialize: function(options) {\n\t\tthis._data           = [];\n\t\tthis._layers         = L.featureGroup();\n\t\tthis._markers        = L.featureGroup();\n\t\tthis._markedSegments = L.polyline([]);\n\t\tthis._chartEnabled   = true,\n\t\tthis.track_info      = {};\n\t\tthis.handlers        = [];\n\n\t\tL.setOptions(this, options);\n\n\t\tif (this.options.followMarker)             this._setMapView = L.Util.throttle(this._setMapView, 300, this);\n\t\tif (this.options.legend)                   this.options.margins.bottom += 30;\n\t\tif (this.options.theme)                    this.options.polylineSegments.className += ' ' + this.options.theme;\n\t\tif (this.options.wptIcons === true)        this.options.wptIcons = Options.wptIcons;\n\t\tif (this.options.distanceMarkers === true) this.options.distanceMarkers = Options.distanceMarkers;\n\n\t\tthis._markedSegments.setStyle(this.options.polylineSegments);\n\n\t\t// Leaflet canvas renderer colors\n\t\tL.extend(D3.Colors, this.options.colors || {});\n\n\t\t// Various stuff\n\t\tthis._fixCanvasPaths();\n\t\tthis._fixTooltipSize();\n\t},\n\n\t/**\n\t * Javascript scripts downloader (lazy loader)\n\t */\n\tlazyLoad: function(src, condition = false, loader = '') {\n\t\tif (!this.options.lazyLoadJS) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tswitch(src) {\n\t\t\tcase this.__D3:\n\t\t\t\tloader    = '_d3LazyLoader';\n\t\t\t\tcondition = typeof d3 !== 'object';\n\t\t\tbreak;\n\t\t\tcase this.__TOGEOJSON:\n\t\t\t\tloader    = '_togeojsonLazyLoader';\n\t\t\t\tcondition = typeof toGeoJSON !== 'object';\n\t\t\tbreak;\n\t\t\tcase this.__LGEOMUTIL:\n\t\t\t\tloader    = '_geomutilLazyLoader';\n\t\t\t\tcondition = typeof L.GeometryUtil !== 'object';\n\t\t\tbreak;\n\t\t\tcase this.__LALMOSTOVER:\n\t\t\t\tloader    = '_almostoverLazyLoader';\n\t\t\t\tcondition = typeof L.Handler.AlmostOver  !== 'function';\n\t\t\tbreak;\n\t\t\tcase this.__LDISTANCEM:\n\t\t\t\tloader    = '_distanceMarkersLazyLoader';\n\t\t\t\tcondition = typeof L.DistanceMarkers  !== 'function';\n\t\t\tbreak;\n\t\t}\n\t\treturn L.Control.Elevation[loader] = _.lazyLoader(src, condition, L.Control.Elevation[loader]);\n\t},\n\n\t/**\n\t * Load elevation data (GPX, GeoJSON, KML or TCX).\n\t */\n\tload: function(data) {\n\t\tthis._parseFromString(data).then( geojson => geojson ? this._loadLayer(geojson) : this._loadFile(data));\n\t},\n\n\t/**\n\t * Create container DOM element and related event listeners.\n\t * Called on control.addTo(map).\n\t */\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme + \" \" + (this.options.detached ? '' : 'leaflet-control'));\n\t\t\n\t\tthis.lazyLoad(this.__D3)\n\t\t\t.then(() => {\n\t\t\t\tthis._initButton(container);\n\t\t\t\tthis._initChart(container);\n\t\t\t\tthis._initSummary(container);\n\t\t\t\tthis._initMarker(map);\n\t\t\t\tthis._initLayer(map);\n\n\t\t\t\tmap\n\t\t\t\t\t.on('zoom viewreset zoomanim',       this._hideMarker,    this)\n\t\t\t\t\t.on('resize',                        this._resetView,     this)\n\t\t\t\t\t.on('resize',                        this._resizeChart,   this)\n\t\t\t\t\t.on('rotate',                        this._rotateMarker,  this)\n\t\t\t\t\t.on('mousedown',                     this._resetDrag,     this);\n\n\t\t\t\t_.on(map.getContainer(), 'mousewheel', this._resetDrag,       this);\n\t\t\t\t_.on(map.getContainer(), 'touchstart', this._resetDrag,       this);\n\t\t\t\t_.on(document,           'keydown',    this._keydownHandler,  this);\n\n\t\t\t\tthis\n\t\t\t\t\t.on('eledata_added eledata_loaded',  this._updateChart,   this)\n\t\t\t\t\t.on('eledata_added eledata_loaded',  this._updateSummary, this);\n\n\t\t\t\tthis._updateChart();\n\t\t\t\tthis._updateSummary();\n\t\t\t});\n\n\t\treturn container;\n\t},\n\n\t/**\n\t * Clean up control code and related event listeners.\n\t * Called on control.remove().\n\t */\n\tonRemove: function(map) {\n\t\tthis._container = null;\n\n\t\tmap\n\t\t\t.off('zoom viewreset zoomanim',       this._hideMarker,    this)\n\t\t\t.off('resize',                        this._resetView,     this)\n\t\t\t.off('resize',                        this._resizeChart,   this)\n\t\t\t.off('mousedown',                     this._resetDrag,     this);\n\n\t\t_.off(map.getContainer(), 'mousewheel', this._resetDrag,       this);\n\t\t_.off(map.getContainer(), 'touchstart', this._resetDrag,       this);\n\t\t_.off(document,           'keydown',    this._keydownHandler,  this);\n\n\t\tthis\n\t\t\t.off('eledata_added eledata_loaded',  this._updateChart,   this)\n\t\t\t.off('eledata_added eledata_loaded',  this._updateSummary, this);\n\t},\n\n\t/**\n\t * Redraws the chart control. Sometimes useful after screen resize.\n\t */\n\tredraw: function() {\n\t\tthis._resizeChart();\n\t},\n\n\t/**\n\t * Set default zoom level (followMarker: true).\n\t */\n\tsetZFollow: function(zoom) {\n\t\tthis.options.zFollow = zoom;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\tshow: function() {\n\t\t_.style(this._container, \"display\", \"block\");\n\t},\n\n\t/*\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\n\t */\n\t_addData: function(d) {\n\t\tif (!d) {\n\t\t\treturn;\n\t\t}\n\n\t\t/**\n\t\t * Standard GeoJSON --> doesn't handle \"time\", \"heart\", \n\t\t */\n\t\tlet geom = d.geometry;\n\t\tif (geom) {\n\t\t\tswitch (geom.type) {\n\t\t\t\tcase 'LineString':\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'MultiLineString':\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\n\t\t\t}\n\t\t}\n\t\tif (d.type === \"FeatureCollection\") {\n\t\t\t_.each(d.features, feature => this._addData(feature));\n\t\t}\n\n\t\t/**\n\t\t * Extended GeoJSON --> rely on leaflet implementation\n\t\t */\n\t\tif (d._latlngs) {\n\t\t\tthis._addGeoJSONData(d._latlngs, d.feature && d.feature.properties);\n\t\t}\n\t},\n\n\t/*\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\n\t */\n\t_addGeoJSONData: function(coords, properties) {\n\t\tcoords.forEach((point, i) => {\n\n\t\t\t// Inspired by L.GPX layer properties\n\t\t\tpoint.meta = point.meta ?? { time: null, ele: null, hr: null, cad: null, atemp: null };\n\t\t\t\n\t\t\t// \"coordinateProperties\" property is generated inside \"@tmcw/toGeoJSON\"\n\t\t\tlet props = (properties && properties.coordinateProperties) || properties;\n\n\t\t\tthis.fire(\"elepoint_init\", { point: point, props: props, id: i });\n\n\t\t\tthis._addPoint(\n\t\t\t\tpoint.lat ?? point[1], \n\t\t\t\tpoint.lng ?? point[0],\n\t\t\t\tpoint.alt ?? point.meta.ele ?? point[2]\n\t\t\t);\n\n\t\t\tthis.fire(\"elepoint_added\", { point: point, index: this._data.length - 1 });\n\t\t});\n\n\t\tthis.fire(\"eletrack_added\", { coords: coords, index: this._data.length - 1 });\n\t},\n\n\t/*\n\t * Parse and push a single (x, y, z) point to current elevation profile.\n\t */\n\t_addPoint: function(x, y, z) {\n\t\tif (this.options.reverseCoords) {\n\t\t\t[x, y] = [y, x];\n\t\t}\n\n\t\tthis._data.push({\n\t\t\tx: x,\n\t\t\ty: y,\n\t\t\tz: z,\n\t\t\tlatlng: L.latLng(x, y, z)\n\t\t});\n\n\t\tthis.fire(\"eledata_updated\", { index: this._data.length - 1 });\n\t},\n\n\t_addLayer: function(layer) {\n\t\tif (layer) this._layers.addLayer(layer)\n\t\t// Postpone adding the distance markers (lazy: true)\n\t\tif (layer && this.options.distanceMarkers && this.options.distanceMarkers.lazy) {\n\t\t\tlayer.on('add remove', (e) => L.DistanceMarkers && e.target instanceof L.Polyline && e.target[e.type + 'DistanceMarkers']());\n\t\t}\n\t},\n\n\t_addMarker: function(marker) {\n\t\tif (marker) this._markers.addLayer(marker)\n\t},\n\n\t/**\n\t * Initialize \"L.AlmostOver\" integration\n\t */\n\t_initAlmostOverHandler: function(map, layer) {\n\t\tif(!map || !this.options.almostOver) return;\n\t\tthis.lazyLoad(this.__LGEOMUTIL)\n\t\t\t.then(() => this.lazyLoad(this.__LALMOSTOVER))\n\t\t\t.then(() => {\n\t\t\t\t\tmap.addHandler('almostOver', L.Handler.AlmostOver)\n\t\t\t\t\tif (L.GeometryUtil && map.almostOver && map.almostOver.enabled()) {\n\t\t\t\t\t\tmap.almostOver.addLayer(layer);\n\t\t\t\t\t\tmap\n\t\t\t\t\t\t\t.on('almost:move', (e) => this._mousemoveLayerHandler(e))\n\t\t\t\t\t\t\t.on('almost:out',  (e) => this._mouseoutHandler(e));\n\t\t\t\t\t}\n\t\t\t});\n\t},\n\n\t/**\n\t * Initialize \"L.DistanceMarkers\" integration\n\t */\n\t_initDistanceMarkers: function(map, layer) {\n\t\tif (!map) return;\n\t\tif (this.options.distanceMarkers) {\n\t\t\tthis.lazyLoad(this.__LGEOMUTIL)\n\t\t\t\t.then(() => this.lazyLoad(this.__LDISTANCEM))\n\t\t\t\t.then(() => this.options.polyline && layer.addTo(map));\n\t\t} else if (this.options.polyline) {\n\t\t\tlayer.addTo(map);\n\t\t}\n\t},\n\n\t/**\n\t * Adds the control to the given \"detached\" div.\n\t */\n\t_initElevationDiv: function() {\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\n\t\tif (!eleDiv) {\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\n\t\t\teleDiv                    = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\n\t\t}\n\t\tif (this.options.detached) {\n\t\t\t_.replaceClass(eleDiv, 'leaflet-control', 'elevation-detached');\n\t\t}\n\t\treturn this.eleDiv = eleDiv;\n\t},\n\n\t/**\n\t * Initialize \"L.AlmostOver\" and \"L.DistanceMarkers\"\n\t */\n\t_initMapIntegrations: function(control, layer) {\n\t\tlet map   = control._map;\n\t\tif (control._map) {\n\t\t\tmap.once('layeradd', (e) => control.options.autofitBounds && control.fitBounds(layer.getBounds()));\n\t\t\tif (!L.Browser.mobile) {\n\t\t\t\tcontrol._initAlmostOverHandler(map, layer);\n\t\t\t\tcontrol._initDistanceMarkers(map, layer);\n\t\t\t} else if (control.options.polyline) {\n\t\t\t\tlayer.addTo(map);\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Undefined elevation map object\");;\n\t\t}\n\t},\n\n\t/*\n\t * Collapse current chart control.\n\t */\n\t_collapse: function() {\n\t\t_.replaceClass(this._container, 'elevation-expanded', 'elevation-collapsed');\n\t},\n\n\t/*\n\t * Expand current chart control.\n\t */\n\t_expand: function() {\n\t\t_.replaceClass(this._container, 'elevation-collapsed', 'elevation-expanded');\n\t},\n\n\t/**\n\t * Add some basic colors to leaflet canvas renderer (preferCanvas: true).\n\t */\n\t_fixCanvasPaths: function() {\n\t\tlet oldProto = L.Canvas.prototype._fillStroke;\n\t\tlet control  = this;\n\t\tL.Canvas.include({\n\t\t\t_fillStroke: function(ctx, layer) {\n\t\t\t\tif (control._layers.hasLayer(layer)) {\n\n\t\t\t\t\tlet theme      = control.options.theme.replace('-theme', '');\n\t\t\t\t\tlet color      = D3.Colors[theme] || {};\n\t\t\t\t\tlet options    = layer.options;\n\n\t\t\t\t\toptions.color  = color.line || color.area || theme;\n\t\t\t\t\toptions.stroke = !!options.color;\n\n\t\t\t\t\toldProto.call(this, ctx, layer);\n\n\t\t\t\t\tif (options.stroke && options.weight !== 0) {\n\t\t\t\t\t\tlet oldVal                   = ctx.globalCompositeOperation || 'source-over';\n\t\t\t\t\t\tctx.globalCompositeOperation = 'destination-over'\n\t\t\t\t\t\tctx.strokeStyle              = color.outline || '#FFF';\n\t\t\t\t\t\tctx.lineWidth                = options.weight * 1.75;\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t\tctx.globalCompositeOperation = oldVal;\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\toldProto.call(this, ctx, layer);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Partial fix for initial tooltip size\n\t * \n\t * @link https://github.com/Raruto/leaflet-elevation/issues/81#issuecomment-713477050\n\t */\n\t_fixTooltipSize: function() {\n\t\tthis.on('elechart_init', () =>\n\t\t\tthis.once('elechart_change elechart_hover', e => {\n\t\t\t\tif (this._chartEnabled) {\n\t\t\t\t\tthis._chart._showDiagramIndicator(e.data, e.xCoord);\n\t\t\t\t\tthis._chart._showDiagramIndicator(e.data, e.xCoord);\n\t\t\t\t}\n\t\t\t\tthis._updateMarker(e.data);\n\t\t\t})\n\t\t);\n\t},\n\n\t/*\n\t * Finds a data entry for the given LatLng\n\t */\n\t_findItemForLatLng: function(latlng) {\n\t\treturn this._data[this._chart._findIndexForLatLng(latlng)];\n\t},\n\n\t/*\n\t * Finds a data entry for the given xDiagCoord\n\t */\n\t_findItemForX: function(x) {\n\t\treturn this._data[this._chart._findIndexForXCoord(x)];\n\t},\n\n\t/**\n\t * Fires an event of the specified type.\n\t */\n\t_fireEvt: function(type, data, propagate) {\n\t\tif (this.fire) this.fire(type, data, propagate);\n\t\tif (this._map) this._map.fire(type, data, propagate);\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tif (this._chart) return this._chart._height();\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\t_hideMarker: function() {\n\t\tif (this.options.autohideMarker) {\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Generate \"svg\" chart (DOM element).\n\t */\n\t_initChart: function(container) {\n\t\tlet opts    = this.options;\n\n\t\topts.xTicks = this._xTicks();\n\t\topts.yTicks = this._yTicks();\n\n\t\tif (opts.detached) {\n\t\t\tlet { offsetWidth, offsetHeight}             = this.eleDiv;\n\t\t\tif (offsetWidth > 0)             opts.width  = offsetWidth;\n\t\t\tif (offsetHeight > 20)           opts.height = offsetHeight - 20; // 20 = horizontal scrollbar size.\n\t\t} else {\n\t\t\tlet { clientWidth }                          = this._map.getContainer();\n\t\t\topts._maxWidth                               = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\n\t\t\tthis._container.style.maxWidth               = opts._maxWidth + 'px';\n\t\t\tif (opts._maxWidth > clientWidth) opts.width = clientWidth - 30;\n\t\t}\n\n\t\tlet chart = this._chart = new Chart(opts, this);\n\n\t\tthis._x     = this._chart._x;\n\t\tthis._y     = this._chart._y;\n\n\t\td3\n\t\t\t.select(container)\n\t\t\t.call(chart.render())\n\n\t\tchart\n\t\t\t.on('reset_drag',     this._hideMarker,                     this)\n\t\t\t.on('mouse_enter',    this._mouseenterHandler,              this)\n\t\t\t.on('dragged',        this._dragendHandler,                 this)\n\t\t\t.on('mouse_move',     this._mousemoveHandler,               this)\n\t\t\t.on('mouse_out',      this._mouseoutHandler,                this)\n\t\t\t.on('ruler_filter',   this._rulerFilterHandler,             this)\n\t\t\t.on('zoom',           this._updateChart,                    this)\n\t\t\t.on('elepath_toggle', this._toggleChartHandler,             this)\n\t\t\t.on('margins_updated',this._resizeChart,                    this);\n\n\n\t\tthis.fire(\"elechart_axis\");\n\n\t\tif (this.options.legend) this.fire(\"elechart_legend\");\n\n\t\tthis.fire(\"elechart_init\");\n\t},\n\n\t_initLayer: function() {\n\t\tthis._layers\n\t\t\t.on('layeradd layerremove', (e) => {\n\t\t\t\tlet layer = e.layer\n\t\t\t\tlet node  = layer.getElement && layer.getElement();\n\t\t\t\t_.toggleClass(node,  this.options.polyline.className + ' ' + this.options.theme, e.type == 'layeradd');\n\t\t\t\t_.toggleEvent(layer, \"mousemove\", this._mousemoveLayerHandler.bind(this),        e.type == 'layeradd')\n\t\t\t\t_.toggleEvent(layer, \"mouseout\",  this._mouseoutHandler.bind(this),              e.type == 'layeradd');\n\t\t\t});\n\t},\n\n\t_initMarker: function(map) {\n\t\tlet pane                     = map.getPane('elevationPane');\n\t\tif (!pane) {\n\t\t\tpane = this._pane        = map.createPane('elevationPane', map.getPane('norotatePane') || map.getPane('mapPane'));\n\t\t\tpane.style.zIndex        = 625; // This pane is above markers but below popups.\n\t\t\tpane.style.pointerEvents = 'none';\n\t\t}\n\n\t\tif (this._renderer) this._renderer.remove()\n\t\tthis._renderer               = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\n\t\tthis._marker                 = new Marker(this.options);\n\n\t\tthis.fire(\"elechart_marker\");\n\t},\n\n\t/**\n\t * Inspired by L.Control.Layers\n\t */\n\t_initButton: function(container) {\n\n\t\tif (L.Browser.mobile || !this.options.detached) {\n\t\t\tL.DomEvent\n\t\t\t\t.disableClickPropagation(container)\n\t\t\t\t.disableScrollPropagation(container);\n\t\t}\n\n\t\tif (!this.options.detached) {\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\n\n\t\t\tif (this.options.collapsed) {\n\t\t\t\tthis._collapse();\n\t\t\t\tif (this.options.autohide) {\n\t\t\t\t\t_.on(container, 'mouseover', this._expand,   this);\n\t\t\t\t\t_.on(container, 'mouseout',  this._collapse, this);\n\t\t\t\t} else {\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\n\t\t\t\t}\n\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\n\n\t\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t}\n\t\t}\n\t},\n\n\t_initSummary: function(container) {\n\t\tthis._summary = new Summary({ summary: this.options.summary }, this);\n\n\t\td3.select(container).call(this._summary.render());\n\t},\n\n\t_keydownHandler: function(e) {\n\t\tif(!this.options.detached && e.key === \"Escape\"){\n\t\t\tthis._collapse()\n\t\t};\n\t},\n\n\t/**\n\t * Retrieve data from a remote url (HTTP).\n\t */\n\t_loadFile: function(url) {\n\t\tfetch(url)\n\t\t\t.then((response) => response.text())\n\t\t\t.then((data)     => {\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\n\t\t\t\tthis._parseFromString(data)\n\t\t\t\t\t.then( geojson => geojson && this._loadLayer(geojson));\n\t\t\t}).catch((err) => console.warn(err));\n\t},\n\n\t/**\n\t * Simple GeoJSON data loader (L.GeoJSON).\n\t */\n\t_loadLayer: function(geojson) {\n\t\tlet control = this;\n\n\t\tlet { wptIcons, wptLabels } = control.options;\n\n\t\tlet layer = L.geoJson(geojson, {\n\t\t\tdistanceMarkers: control.options.distanceMarkers,\n\t\t\tstyle: (feature) => {\n\t\t\t\tlet style = L.extend({}, control.options.polyline);\n\t\t\t\tif (control.options.theme) {\n\t\t\t\t\tstyle.className += ' ' + control.options.theme;\n\t\t\t\t}\n\t\t\t\treturn style;\n\t\t\t},\n\t\t\tpointToLayer: (feature, latlng) => {\n\t\t\t\tif (!control.options.waypoints) return;\n\n\t\t\t\tlet prop   = feature.properties;\n\t\t\t\tlet desc   = prop.desc ?? '';\n\t\t\t\tlet name   = prop.name ?? '';\n\t\t\t\tlet sym    = (prop.sym ?? name).replace(' ', '-').replace('\"', '').replace(\"'\", '').toLowerCase();\n\n\t\t\t\t// Handle chart waypoints (dots)\n\t\t\t\tif ([true, 'dots'].includes(control.options.waypoints)) {\n\t\t\t\t\tcontrol._registerCheckPoint({\n\t\t\t\t\t\tlatlng: latlng,\n\t\t\t\t\t\tlabel: ([true, 'dots'].includes(wptLabels) ? name : '')\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Handle map waypoints (markers)\n\t\t\t\tif ([true, 'markers'].includes(control.options.waypoints) && wptIcons != false) {\n\t\t\t\t\t// generate and cache appropriate icon symbol\n\t\t\t\t\tif (!wptIcons.hasOwnProperty(sym)) {\n\t\t\t\t\t\twptIcons[sym] = L.divIcon(\n\t\t\t\t\t\t\tL.extend({}, wptIcons[\"\"].options, { html: '<i class=\"elevation-waypoint-icon ' + sym + '\"></i>' } )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tlet marker = L.marker(latlng, { icon: wptIcons[sym] });\n\t\t\t\t\tif ([true, 'markers'].includes(wptLabels) && (name || desc)) {\n\t\t\t\t\t\tlet content = decodeURI(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : ''));\n\t\t\t\t\t\tmarker.bindPopup(content, { className: 'elevation-popup', keepInView: true }).openPopup();\n\t\t\t\t\t\tmarker.bindTooltip(content, { className: 'elevation-tooltip', direction: 'auto', sticky: true, opacity: 1 }).openTooltip();\n\t\t\t\t\t}\n\t\t\t\t\tcontrol._addMarker(marker);\n\t\t\t\t\tcontrol.fire('waypoint_added', { point: marker, element: latlng, properties: prop });\n\t\t\t\t\treturn marker;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonEachFeature: (feature, layer) => {\n\t\t\t\tif (feature.geometry && feature.geometry.type != 'Point') {\n\t\t\t\t\tcontrol.addData(layer);\n\t\t\t\t\tcontrol.track_info = L.extend({}, control.track_info, { name: geojson.name });\n\t\t\t\t} \n\t\t\t},\n\t\t});\n\n\t\tcontrol.lazyLoad(control.__D3).then(() => {\n\t\t\tcontrol._initMapIntegrations(control, layer);\n\t\t\tcontrol._fireEvt(\"eledata_loaded\", { data: geojson, layer: layer, name: control.track_info.name, track_info: control.track_info })\n\t\t});\n\n\t\treturn layer;\n\t},\n\n\t_dragendHandler: function(e) {\n\t\tthis._hideMarker();\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\n\n\t\tthis.fire(\"elechart_dragged\");\n\t},\n\n\t/**\n\t * Trigger mouseenter event\n\t */\n\t_mouseenterHandler: function(e) {\n\t\tthis.fire('elechart_enter');\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(e) {\n\t\tif (!this._data.length || !this._chartEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tlet item = this._findItemForX(e.xCoord);\n\n\t\tif (item) {\n\t\t\tlet xCoord = e.xCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._updateMarker(item);\n\t\t\tthis._setMapView(item);\n\n\t\t\tif (this._map) {\n\t\t\t\t_.addClass(this._map.getContainer(), 'elechart-hover');\n\t\t\t}\n\n\t\t\tthis.fire(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t\tthis.fire(\"elechart_hover\",  { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles mouseover events of the data layers on the map.\n\t */\n\t_mousemoveLayerHandler: function(e) {\n\t\tif (!this._data.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = this._findItemForLatLng(e.latlng);\n\t\tif (item) {\n\t\t\tlet xCoord = item.xDiagCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._updateMarker(item);\n\n\t\t\tthis.fire(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tif (!this.options.detached) {\n\t\t\tthis._hideMarker();\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t}\n\n\t\tif (this._map) {\n\t\t\t_.removeClass(this._map.getContainer(), 'elechart-hover');\n\t\t}\n\n\t\tthis.fire(\"elechart_leave\");\n\t},\n\n\t/**\n\t * Simple GeoJSON Parser\n\t */\n\t_parseFromGeoJSONString: function(data) {\n\t\ttry {\n\t\t\treturn JSON.parse(data);\n\t\t} catch (e) { }\n\t},\n\n\t/**\n\t * Attempt to parse raw response data (GeoJSON or XML > GeoJSON)\n\t */\n\t_parseFromString: function(data) {\n\t\treturn new Promise(resolve =>\n\t\t\tthis.lazyLoad(this.__TOGEOJSON).then(() => {\n\t\t\t\tlet geojson;\n\t\t\t\ttry {\n\t\t\t\t\tgeojson = this._parseFromXMLString(data.trim());\n\t\t\t\t} catch (e) {\n\t\t\t\t\tgeojson = this._parseFromGeoJSONString(data.toString());\n\t\t\t\t}\n\t\t\t\tif (geojson) {\n\t\t\t\t\tgeojson = this._prepareMultiLineStrings(geojson);\n\t\t\t\t\tgeojson = this._prepareAdditionalProperties(geojson);\n\t\t\t\t}\n\t\t\t\tresolve(geojson);\n\t\t\t})\n\t\t);\n\t},\n\n\t/**\n\t * Simple XML Parser (GPX, KML, TCX)\n\t */\n\t_parseFromXMLString: function(data) {\n\t\tif (data.indexOf(\"<\") != 0) {\n\t\t\tthrow 'Invalid XML';\n\t\t}\n\t\tlet xml  = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\tlet type = xml.documentElement.tagName.toLowerCase(); // \"kml\" or \"gpx\"\n\t\tlet name = xml.getElementsByTagName('name');\n\t\tif (xml.getElementsByTagName('parsererror').length) {\n\t\t\tthrow 'Invalid XML';\n\t\t}\n\t\tif (!(type in toGeoJSON)) {\n\t\t\ttype = xml.documentElement.tagName == \"TrainingCenterDatabase\" ? 'tcx' : 'gpx';\n\t\t}\n\t\tlet geojson  = toGeoJSON[type](xml);\n\t\tgeojson.name = name.length > 0 ? (Array.from(name).find(tag => tag.parentElement.tagName == \"trk\") ?? name[0]).textContent : '';\n\t\treturn geojson;\n\t},\n\n\t/**\n\t * Extend GeoJSON properties (name, time, ...)\n\t */\n\t _prepareAdditionalProperties: function(geojson) {\n\t\tif (!geojson.name && this._downloadURL) {\n\t\t\tgeojson.name = this._downloadURL.split('/').pop().split('#')[0].split('?')[0];\n\t\t}\n\t\treturn geojson;\n\t},\n\n\t/**\n\t * Just a temporary fix for MultiLineString data (trk > trkseg + trkseg),\n\t * just split them into seperate LineStrings (trk > trkseg, trk > trkseg)\n\t * \n\t * @link https://github.com/Raruto/leaflet-elevation/issues/56\n\t */\n\t_prepareMultiLineStrings: function(geojson) {\n\t\tgeojson.features.forEach(feauture => {\n\t\t\tif (feauture.geometry.type == \"MultiLineString\") {\n\t\t\t\tfeauture.geometry.coordinates.forEach(coords => {\n\t\t\t\t\tgeojson.features.push({\n\t\t\t\t\t\tgeometry: { type: 'LineString', coordinates: coords },\n\t\t\t\t\t\tproperties: feauture.properties,\n\t\t\t\t\t\ttype: 'Feature'\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} \n\t\t});\n\t\treturn geojson.features.filter(feauture => feauture.geometry.type != \"MultiLineString\");\n\t},\n\n\t/**\n\t * Add chart profile to diagram\n\t */\n\t_registerAreaPath: function(props) {\n\t\tthis.on(\"elechart_init\", () => this._chart._registerAreaPath(props));\n\t},\n\n\t/**\n\t * Add chart grid to diagram\n\t */\n\t_registerAxisGrid: function(props) {\n\t\tthis.on(\"elechart_axis\", () => this._chart._registerAxisGrid(props));\n\t},\n\n\t/**\n\t * Add chart axis to diagram\n\t */\n\t_registerAxisScale: function(props) {\n\t\tthis.on(\"elechart_axis\", () => this._chart._registerAxisScale(props));\n\t},\n\n\t/**\n\t * Add a point of interest over the diagram\n\t */\n\t_registerCheckPoint: function(props) {\n\t\tthis.on(\"elechart_updated\", () => this._chart._registerCheckPoint(props));\n\t},\n\n\n\t/**\n\t * Base handler for iterative track statistics (dist, time, z, slope, speed, acceleration, ...)\n\t */\n\t _registerDataAttribute: function(props) {\n\t\t// save here a reference to last used point\n\t\tlet lastValid = null; \n\n\t\t// parse of \"coordinateProperties\" for later usage\n\t\tif (props.init) {\n\t\t\tthis.on(\"elepoint_init\", (e) => props.init.call(this, e));\n\t\t}\n\n\t\t// iteration\n\t\tthis.on(\"elepoint_added\", (e) => {\n\n\t\t\t// check and fix missing data on last added point\n\t\t\tif (props.skipNull === false) {\n\t\t\t\tlet curr = this._data[e.index][props.name];\n\t\t\t\tif(e.index > 0) {\n\t\t\t\t\tlet prev = this._data[e.index - 1][props.name];\n\t\t\t\t\tif (isNaN(prev)) {\n\t\t\t\t\t\tif (!isNaN(lastValid) && !isNaN(curr)) {\n\t\t\t\t\t\t\tprev   = (lastValid + curr) / 2;\n\t\t\t\t\t\t} else if (!isNaN(lastValid)) {\n\t\t\t\t\t\t\tprev   = lastValid;\n\t\t\t\t\t\t} else if (!isNaN(curr)) {\n\t\t\t\t\t\t\tprev   = curr;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isNaN(prev)) return this._data.splice(e.index - 1, 1);\n\t\t\t\t\t\tthis._data[e.index - 1][props.name] = prev;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// update reference to last used point (ie. if it has data)\n\t\t\t\tif (!isNaN(curr)) {\n\t\t\t\t\tlastValid = curr;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// retrieve point value\n\t\t\tthis._data[e.index][props.name] = props.fetch.call(this, e.index, e.point);\n\n\t\t\t// update here some mixins (eg. \"track_info\", value validators, ...)\n\t\t\tif(props.update) this._data[e.index][props.name] = props.update.call(this, this._data[e.index][props.name], e.index, e.point)\n\t\t});\n\t},\n\t\n\t/**\n\t * Add chart or marker tooltip info\n\t */\n\t_registerTooltip: function(props) {\n\t\tif (props.chart) {\n\t\t\tlet label = L.extend({}, props, { value: props.chart });\n\t\t\tthis.on(\"elechart_init\",   () => this._chart._registerTooltip(label));\n\t\t}\n\t\tif (props.marker) {\n\t\t\tlet label = L.extend({}, props, { value: props.marker });\n\t\t\tthis.on(\"elechart_marker\", () => this._marker._registerTooltip(label));\n\t\t}\n\t},\n\n\t/**\n\t * Add summary info to diagram\n\t */\n\t_registerSummary: function(props) {\n\t\tthis.on('elechart_summary',  () => this._summary._registerSummary(props));\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tthis._chart._resetDrag();\n\t\tthis._hideMarker();\n\t},\n\n\t/**\n\t * Resets drag, marker and bounds.\n\t */\n\t_resetView: function() {\n\t\tif (this._map && this._map._isFullscreen) return;\n\t\tthis._resetDrag();\n\t\tthis._hideMarker();\n\t\tif (this.options.autofitBounds) {\n\t\t\tthis.fitBounds();\n\t\t}\n\t},\n\n\t/**\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\n\t */\n\t_resizeChart: function() {\n\t\tif(!this._container) return;\n\n\t\t// prevent displaying chart on resize if hidden\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\n\n\t\tlet opts = this.options;\n\n\t\tlet newWidth;\n\n\t\tif (opts.detached) {\n\t\t\tnewWidth = (this.eleDiv || this._container).offsetWidth;\n\t\t} else {\n\t\t\tlet { clientWidth } = this._map.getContainer();\n\t\t\tnewWidth = opts._maxWidth > clientWidth ? clientWidth - 30 : opts._maxWidth;\n\t\t}\n\t\t\n\t\tif (newWidth) {\n\t\t\tlet chart  = this._chart;\n\t\t\topts.width = newWidth;\n\t\t\tif (chart && chart._chart) {\n\t\t\t\tchart._chart._resize(opts);\n\t\t\t\topts.xTicks = this._xTicks();\n\t\t\t\topts.yTicks = this._yTicks();\n\t\t\t\tthis._updateChart();\n\t\t\t}\n\t\t}\n\n\t\tthis._updateMapSegments();\n\t},\n\n\t/**\n\t * Handles the drag event over the ruler filter.\n\t */\n\t_rulerFilterHandler: function(e) {\n\t\tthis._updateMapSegments(e.coords);\n\t},\n\n\t/**\n\t * Collapse or Expand chart control.\n\t */\n\t_toggle: function() {\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\n\t\t\tthis._collapse();\n\t\telse\n\t\t\tthis._expand();\n\t},\n\n\t/**\n\t * Update map center and zoom (followMarker: true)\n\t */\n\t_setMapView: function(item) {\n\t\tif (!this.options.followMarker || !this._map) return;\n\t\tlet zoom = this._map.getZoom();\n\t\tlet z    = this.options.zFollow;\n\t\tif (typeof z === \"number\") {\n\t\t\tthis._map.setView(item.latlng, (zoom < z ? z : zoom), { animate: true, duration: 0.25 });\n\t\t} else if (!this._map.getBounds().contains(item.latlng)) {\n\t\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t\t}\n\t},\n\n\t/**\n\t * Toggle chart data on legend click\n\t */\n\t_toggleChartHandler: function(e) {\n\t\tlet { name, enabled } = e;\n\n\t\tthis._chartEnabled = this._chart._hasActiveLayers();\n\n\t\t// toggle layer visibility on empty chart\n\t\tthis._layers.eachLayer(layer => _.toggleClass(layer.getElement && layer.getElement(), this.options.polyline.className + ' ' + this.options.theme, this._chartEnabled));\n\n\t\t// toggle option value (eg. altitude = { 'disabled' || 'disabled' })\n\t\tthis.options[name] = !enabled && this.options[name] == 'disabled' ? 'enabled' : 'disabled';\n\n\t\t// remove marker on empty chart\n\t\tif (!this._chartEnabled) {\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Calculates [x, y] domain and then update chart.\n\t */\n\t_updateChart: function() {\n\t\tif (/*!this._data.length ||*/ !this._chart || !this._container) return;\n\n\t\tthis.fire(\"elechart_axis\");\n\t\tthis.fire(\"elechart_area\");\n\n\t\tthis._chart.update({ data: this._data, options: this.options });\n\n\t\tthis._x     = this._chart._x;\n\t\tthis._y     = this._chart._y;\n\n\t\tthis.fire('elechart_updated');\n\t},\n\n\t/*\n\t * Update the position/height indicator marker drawn onto the map\n\t */\n\t_updateMarker: function(item) {\n\t\tif (this._marker) {\n\t\t\tthis._marker.update({\n\t\t\t\tmap         : this._map,\n\t\t\t\titem        : item,\n\t\t\t\tmaxElevation: this.track_info.elevation_max || 0,\n\t\t\t\toptions     : this.options\n\t\t\t});\n\t\t}\n\t},\n\n\t/**\n\t * Fix marker rotation on rotated maps\n\t */\n\t_rotateMarker: function() {\n\t\tif (this._marker) {\n\t\t\tthis._marker.update();\n\t\t}\n\t},\n\n\t/**\n\t * Highlight track segments on the map.\n\t */\n\t_updateMapSegments: function(coords) {\n\t\tthis._markedSegments.setLatLngs(coords || []);\n\t\tif (coords && this._map && !this._map.hasLayer(this._markedSegments)) {\n\t\t\tthis._markedSegments.addTo(this._map);\n\t\t}\n\t},\n\n\t/**\n\t * Update chart summary.\n\t */\n\t_updateSummary: function() {\n\t\tthis._summary.reset();\n\n\t\tif (this.options.summary) {\n\t\t\tthis.fire(\"elechart_summary\");\n\t\t\tthis._summary.update();\n\t\t}\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\n\t\t\tthis._summary._container.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\n\t\t\t_.select('.download a', this._summary._container).onclick = (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tlet event = { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) };\n\t\t\t\tif (this.options.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\n\t\t\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: event }));\n\t\t\t\t} else if (this.options.downloadLink == 'link' || this.options.downloadLink === true) {\n\t\t\t\t\tevent.confirm();\n\t\t\t\t}\n\t\t\t\tthis.fire('eletrack_download', event);\n\t\t\t};\n\t\t};\n\t},\n\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tif (this._chart) return this._chart._width();\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n\t/**\n\t * Calculate chart xTicks\n\t */\n\t_xTicks: function() {\n\t\tif (this.__xTicks) this.__xTicks = this.options.xTicks;\n\t\treturn this.__xTicks || Math.round(this._width() / 75);\n\t},\n\n\t/**\n\t * Calculate chart yTicks\n\t */\n\t_yTicks: function() {\n\t\tif (this.__yTicks) this.__yTicks = this.options.yTicks;\n\t\treturn this.__yTicks || Math.round(this._height() / 30);\n\t}\n\n});","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts     = this.options;\n\tlet distance = {};\n\n\tif (opts.imperial) {\n\t\topts.distanceFactor = this.__mileFactor;\n\t\tdistance.label      = \"mi\";\n\t} else {\n\t\topts.distanceFactor = opts.distanceFactor || 1;\n\t\tdistance.label      = opts.xLabel;\n\t}\n\n\tthis._registerDataAttribute({\n\t\tname: 'dist',\n\t\tinit: () => {\n\t\t\t// this.track_info.distance = 0;\n\t\t},\n\t\tfetch: (i) => {\n\t\t\tlet delta = this._data[i].latlng.distanceTo(this._data[i > 0 ? i - 1 : i].latlng) * opts.distanceFactor;\n\t\t\treturn Math.round(delta / 1000 * 100000) / 100000; // handles floating points calc\n\t\t},\n\t\tupdate: (distance) => {\n\t\t\tthis.track_info.distance = this.track_info.distance || 0;\n\t\t\tthis.track_info.distance += distance;\n\t\t\treturn this.track_info.distance;\n\t\t}\n\t});\n\n\tif (this.options.distance != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis    : \"x\",\n\t\t\tposition: \"bottom\",\n\t\t\tscale   : \"x\", // this._chart._x,\n\t\t\tlabel   : distance.label,\n\t\t\tlabelY  : 25,\n\t\t\tlabelX  : () => this._width() + 6,\n\t\t\tname    : \"distance\",\n\t\t});\n\n\t}\n\n\tthis._registerAxisGrid({\n\t\taxis      : \"x\",\n\t\tposition  : \"bottom\",\n\t\tscale     : \"x\" // this._chart._x,\n\t});\n\n\tthis._registerTooltip({\n\t\tname: 'x',\n\t\tchart: (item) => L._(\"x: \") + d3.format(\".\" + opts.decimalsX + \"f\")(item[opts.xAttr]) + \" \" + distance.label,\n\t\torder: 20\n\t});\n\n\tthis._registerSummary({\n\t\t\"totlen\"  : {\n\t\t\tlabel: \"Total Length: \",\n\t\t\tvalue: (track) => (track.distance || 0).toFixed(2) + '&nbsp;' + distance.label,\n\t\t\torder: 10\n\t\t}\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts = this.options;\n\tlet time = {};\n\n\ttime.label      = opts.timeLabel  || 't';\n\topts.timeFactor = opts.timeFactor || 3600;\n\n\t/**\n\t * Common AVG speeds:\n\t * ----------------------\n\t *  slow walk = 1.8  km/h\n\t *  walking   = 3.6  km/h <-- default: 3.6\n\t *  running   = 10.8 km/h\n\t *  cycling   = 18   km/h\n\t *  driving   = 72   km/h\n\t * ----------------------\n\t */\n\tthis._timeAVGSpeed = (opts.timeAVGSpeed || 3.6) * (opts.speedFactor || 1);\n\n\tif (!opts.timeFormat) {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleString().replaceAll('/', '-').replaceAll(',', ' ');\n\t} else if (opts.timeFormat == 'time') {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleTimeString();\n\t} else if (opts.timeFormat == 'date') {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleDateString();\n\t}\n\n\topts.xTimeFormat = opts.xTimeFormat || ((t) => _.formatTime(t).split(\"'\")[0]);\n\n\tthis._registerDataAttribute({\n\t\tname: 'time',\n\t\tinit: function({ point, props, id }) {\n\t\t\t// \"coordinateProperties\" property is generated inside \"@tmcw/toGeoJSON\"\n\t\t\tif (props) {\n\t\t\t\tif(\"coordTimes\" in props)     point.meta.time = new Date(Date.parse(props.coordTimes[id]));\n\t\t\t\telse if(\"times\" in props)     point.meta.time = new Date(Date.parse(props.times[id]));\n\t\t\t\telse if(\"time\" in props)      point.meta.time = new Date(Date.parse((typeof props.time === 'object' ? props.time[id] : props.time)));\n\t\t\t}\n\t\t},\n\t\tfetch: function(i, point) {\n\t\t\t// Add missing timestamps (see: options.timeAVGSpeed)\n\t\t\tif (!point.meta || !point.meta.time) {\n\t\t\t\tpoint.meta = point.meta || {};\n\t\t\t\tif(i > 0) {\n\t\t\t\t\tlet dx = (this._data[i].dist - this._data[i - 1].dist);\n\t\t\t\t\tlet t0 = this._data[i - 1].time.getTime();\n\t\t\t\t\tlet dt = ( dx / this._timeAVGSpeed) * this.options.timeFactor * 1000;\n\t\t\t\t\tpoint.meta.time = new Date(t0 + dt);\n\t\t\t\t} else {\n\t\t\t\t\tpoint.meta.time = new Date(Date.now())\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet time = point.meta.time;\n\t\t\t// Handle timezone offset\n\t\t\tif (time.getTime() - time.getTimezoneOffset() * 60 * 1000 === 0) {\n\t\t\t\ttime = 0;\n\t\t\t}\n\t\t\treturn time;\n\t\t},\n\t\tupdate: function(time, i) {\n\t\t\tthis.track_info.time   = (this.track_info.time || 0) + Math.abs(this._data[i].time - this._data[i > 0 ? i - 1 : i].time);\n\t\t\tthis._data[i].duration = this.track_info.time;\n\t\t\treturn time;\n\t\t}\n\t});\n\n\tif (opts.time && opts.time != \"summary\" && !L.Browser.mobile) {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"x\",\n\t\t\tposition   : \"top\",\n\t\t\tscale      : {\n\t\t\t\tattr       : \"duration\",\n\t\t\t\tmin        : 0,\n\t\t\t},\n\t\t\tlabel      : time.label,\n\t\t\tlabelY     : -10,\n\t\t\tlabelX     : () => this._width(),\n\t\t\tname       : \"time\",\n\t\t\ttickFormat : (d)  => (d == 0 ? '' : opts.xTimeFormat(d)),\n\t\t\tonAxisMount: axis => {\n\t\t\t\taxis.select(\".domain\")\n\t\t\t\t\t.remove();\n\t\t\t\taxis.selectAll(\"text\")\n\t\t\t\t\t.attr('opacity', 0.65)\n\t\t\t\t\t.style('font-family', 'Monospace')\n\t\t\t\t\t.style('font-size', '110%');\n\t\t\t\taxis.selectAll(\".tick line\")\n\t\t\t\t\t.attr('y2', this._height())\n\t\t\t\t\t.attr('stroke-dasharray', 2)\n\t\t\t\t\t.attr('opacity', 0.75);\n\t\t\t\t}\n\t\t});\n\n\t}\n\n\tif (this.options.timestamps) {\n\t\tthis._registerTooltip({\n\t\t\tname: 'date',\n\t\t\tchart: (item) => L._(\"t: \") + this.options.timeFormat(item.time),\n\t\t\torder: 20,\n\t\t});\n\t}\n\n\tif (this.options.time) {\n\t\tthis._registerTooltip({\n\t\t\tname: 'time',\n\t\t\tchart: (item) => L._(\"T: \") + _.formatTime(item.duration || 0),\n\t\t\torder: 20\n\t\t});\n\t\tthis._registerSummary({\n\t\t\t\"tottime\"  : {\n\t\t\t\tlabel: \"Total Time: \",\n\t\t\t\tvalue: (track) => _.formatTime(track.time || 0),\n\t\t\t\torder: 20\n\t\t\t}\n\t\t});\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts       = this.options;\n\tlet altitude   = {};\n\n\tlet theme      = opts.theme.replace('-theme', '');\n\tlet color      = D3.Colors[theme] || {};\n\n\tif (opts.imperial) {\n\t\topts.altitudeFactor = this.__footFactor;\n\t\taltitude.label      = \"ft\";\n\t} else {\n\t\topts.altitudeFactor = opts.heightFactor || opts.altitudeFactor || 1;\n\t\taltitude.label      = opts.yLabel;\n\t}\n\n\tthis._registerDataAttribute({\n\t\tname: 'z',\n\t\tskipNull: this.options.skipNullZCoords,\n\t\tinit: ({point, }) => {\n\t\t\t// \"alt\" property is generated inside \"leaflet\"\n\t\t\tif (\"alt\" in point) point.meta.ele = point.alt;\n\n\t\t\t// this.track_info.elevation_max = -Infinity;\n\t\t\t// this.track_info.elevation_min = +Infinity;\n\t\t\t// this.track_info.elevation_avg = 0;\n\t\t},\n\t\tfetch: (i) => {\n\t\t\treturn this._data[i].z * opts.altitudeFactor;\n\t\t},\n\t\tupdate: (z, i) => {\n\t\t\tthis.track_info.elevation_max = this.track_info.elevation_max || -Infinity;\n\t\t\tthis.track_info.elevation_min = this.track_info.elevation_max || +Infinity;\n\t\t\tthis.track_info.elevation_avg = this.track_info.elevation_avg || 0;\n\n\t\t\tlet data  = this._data;\n\t\t\tlet track = this.track_info;\n\n\t\t\t// Try to smooth \"crazy\" elevation values.\n\t\t\tif (this.options.altitudeDeltaMax) {\n\t\t\t\tlet delta    = z - data[i > 0 ? i - 1 : i].z;\n\t\t\t\tlet deltaMax = this.options.altitudeDeltaMax;\n\t\t\t\tif (Math.abs(delta) > deltaMax) {\n\t\t\t\t\tz = data[i - 1].z + deltaMax * Math.sign(delta);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Range of acceptable elevation values.\n\t\t\tz = _.clamp(z, this.options.altitudeRange);\n\n\t\t\tif (z > track.elevation_max) track.elevation_max = z;\n\t\t\tif (z < track.elevation_min) track.elevation_min = z;\n\n\t\t\ttrack.elevation_avg = (z + track.elevation_avg) / 2.0;\n\n\t\t\treturn z;\n\t\t}\n\t});\n\n\tthis._registerAxisScale({\n\t\taxis    : \"y\",\n\t\tposition: \"left\",\n\t\tscale   : \"y\", // this._chart._y,\n\t\tlabel   : altitude.label,\n\t\tlabelX  : -3,\n\t\tlabelY  : -8,\n\t\tname    : \"altitude\",\n\t\tvisbile : this.options.altitude != \"summary\"\n\t});\n\n\tthis._registerAxisGrid({\n\t\taxis      : \"y\",\n\t\tposition  : \"left\",\n\t\tscale     : \"y\" // this._chart._y,\n\t});\n\n\tthis._registerAreaPath({\n\t\tname         : 'altitude',\n\t\tlabel        : 'Altitude',\n\t\tscaleX       : 'distance',\n\t\tscaleY       : 'altitude',\n\t\tcolor        : color.area || theme,\n\t\tstrokeColor  : opts.detached ? color.stroke : '#000',\n\t\tstrokeOpacity: \"1\",\n\t\tfillOpacity  : opts.detached ? (color.alpha || '0.8') : 1,\n\t\tpreferCanvas : opts.preferCanvas,\n\t\tvisbile      : this.options.altitude != \"summary\"\n\t});\n\n\tthis._registerTooltip({\n\t\tname: 'y',\n\t\tchart: (item) => L._(\"y: \") + d3.format(\".\" + opts.decimalsY + \"f\")(item[opts.yAttr]) + \" \" + altitude.label,\n\t\tmarker: (item) => d3.format(\".\" + opts.decimalsY + \"f\")(item[opts.yAttr]) + \" \" + altitude.label,\n\t\torder: 10,\n\t});\n\n\tthis._registerSummary({\n\t\t\"maxele\"  : {\n\t\t\tlabel: \"Max Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_max || 0).toFixed(2) + '&nbsp;' + altitude.label,\n\t\t\torder: 30,\n\t\t},\n\t\t\"minele\"  : {\n\t\t\tlabel: \"Min Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_min || 0).toFixed(2) + '&nbsp;' + altitude.label,\n\t\t\torder: 30,\n\t\t},\n\t\t\"avgele\"  : {\n\t\t\tlabel: \"Avg Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_avg || 0).toFixed(2) + '&nbsp;' + altitude.label,\n\t\t\torder: 30,\n\t\t},\n\t});\n});","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.slope) return;\n\n\tlet opts  = this.options;\n\tlet slope = {};\n\n\tslope.label          = opts.slopeLabel || '%';\n\n\tthis._registerDataAttribute({\n\t\tname: 'slope',\n\t\t// init: () => {\n\t\t// \t// this.track_info.ascent    = 0;         // Total Ascent\n\t\t// \t// this.track_info.descent   = 0;         // Total Descent\n\t\t// \t// this.track_info.slope_max = -Infinity; // Slope Max\n\t\t// \t// this.track_info.slope_min = +Infinity; // Slope Min\n\t\t// \t// this.track_info.slope_avg = 0;         // Acceleration Avg\n\t\t// },\n\t\tfetch: (i) => {\n\t\t\tlet data  = this._data;\n\t\t\tlet dx    = (data[i].dist - data[i > 0 ? i - 1 : i].dist) * 1000;\n\t\t\tlet dz    = data[i].z - data[i > 0 ? i - 1 : i].z;\n\t\t\treturn (!isNaN(dz) && dx !== 0) ? (dz / dx) * 100 : 0; // slope in % = ( height / length ) * 100;\n\t\t},\n\t\tupdate: (slope, i) => {\n\t\t\tthis.track_info.ascent    = this.track_info.ascent    || 0;         // Total Ascent\n\t\t\tthis.track_info.descent   = this.track_info.descent   || 0;         // Total Descent\n\t\t\tthis.track_info.slope_max = this.track_info.slope_max || -Infinity; // Slope Max\n\t\t\tthis.track_info.slope_min = this.track_info.slope_min || +Infinity; // Slope Min\n\t\t\tthis.track_info.slope_avg = this.track_info.slope_avg || 0;         // Acceleration Avg\n\n\t\t\tlet track = this.track_info;\n\t\t\tlet data  = this._data;\n\t\t\tlet dz    = data[i].z - data[i > 0 ? i - 1 : i].z;\n\n\t\t\t// Try to smooth \"crazy\" acceleration values.\n\t\t\tif (this.options.slopeDeltaMax) {\n\t\t\t\tlet delta    = slop - data[i > 0 ? i - 1 : i].slope;\n\t\t\t\tlet deltaMax = this.options.slopeDeltaMax;\n\t\t\t\tif (Math.abs(delta) > deltaMax) {\n\t\t\t\t\tslope = data[i - 1].slope + deltaMax * Math.sign(delta);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Range of acceptable slope values.\n\t\t\tslope = _.clamp(slope, this.options.slopeRange);\n\n\t\t\tif (dz > 0)      this.track_info.ascent += dz;\n\t\t\telse if (dz < 0) this.track_info.descent -= dz;\n\n\t\t\tif (slope > track.slope_max) track.slope_max = slope;\n\t\t\tif (slope < track.slope_min) track.slope_min = slope;\n\n\t\t\ttrack.slope_avg = (slope + track.slope_avg) / 2.0;\n\n\t\t\treturn L.Util.formatNum(slope, 2);;\n\t\t}\n\t});\n\n\tthis._registerAxisScale({\n\t\taxis       : \"y\",\n\t\tposition   : \"right\",\n\t\tscale      : {\n\t\t\tmin        : -1,\n\t\t\tmax        : +1,\n\t\t},\n\t\ttickPadding: 16,\n\t\tlabel      : slope.label,\n\t\tlabelX     : 25,\n\t\tlabelY     : -8,\n\t\tname       : 'slope',\n\t\tvisbile    : this.options.slope != \"summary\"\n\t});\n\n\tthis._registerAreaPath({\n\t\tname         : 'slope',\n\t\tlabel        : 'Slope',\n\t\tyAttr        : 'slope',\n\t\tscaleX       : 'distance',\n\t\tscaleY       : 'slope',\n\t\tcolor        : '#F00',\n\t\tstrokeColor  : '#000',\n\t\tstrokeOpacity: \"0.5\",\n\t\tfillOpacity  : \"0.25\",\n\t\tvisbile      : this.options.slope != \"summary\"\n\t});\n\n\tthis._registerTooltip({\n\t\tname: 'slope',\n\t\tchart: (item) => L._(\"m: \") + item.slope + slope.label,\n\t\tmarker: (item) => Math.round(item.slope) + slope.label,\n\t\torder: 40,\n\t});\n\n\tthis._registerSummary({\n\t\t\"ascent\"  : {\n\t\t\tlabel: \"Total Ascent: \",\n\t\t\tvalue: (track) => Math.round(track.ascent || 0) + '&nbsp;' + (this.options.imperial ? 'ft' : 'm'),\n\t\t\torder: 40\n\t\t},\n\t\t\"descent\"  : {\n\t\t\tlabel: \"Total Descent: \",\n\t\t\tvalue: (track) => Math.round(track.descent || 0) + '&nbsp;' + (this.options.imperial ? 'ft' : 'm'),\n\t\t\torder: 40\n\t\t},\n\t\t\"minslope\": {\n\t\t\tlabel: \"Min Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_min || 0) + '&nbsp;' + slope.label,\n\t\t\torder: 40\n\t\t},\n\t\t\"maxslope\": {\n\t\t\tlabel: \"Max Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_max || 0) + '&nbsp;' + slope.label,\n\t\t\torder: 40\n\t\t},\n\t\t\"avgslope\": {\n\t\t\tlabel: \"Avg Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_avg || 0) + '&nbsp;' + slope.label,\n\t\t\torder: 40\n\t\t}\n\t});\n\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.speed && !this.options.acceleration) return;\n\n\tlet opts = this.options;\n\tlet speed = {};\n\n\tspeed.label      = opts.speedLabel  || L._(opts.imperial ? 'mph' : 'km/h');\n\topts.speedFactor = opts.speedFactor || 1;\n\n\n\tthis._registerDataAttribute({\n\t\tname: 'speed',\n\t\tinit: () => {\n\t\t\t// this.track_info.speed_max = -Infinity; // Speed Max\n\t\t\t// this.track_info.speed_min = +Infinity; // Speed Min\n\t\t\t// this.track_info.speed_avg = 0;         // Speed Avg\n\t\t},\n\t\tfetch: (i) => {\n\t\t\tlet data = this._data;\n\t\t\tlet dx   = (data[i].dist - data[i > 0 ? i - 1 : i].dist) * 1000;\n\t\t\tlet dt   = data[i].time - data[ i > 0 ? i - 1 : i].time;\n\t\t\treturn dt > 0 ? Math.abs((dx / dt) * opts.timeFactor) * opts.speedFactor : 0;\n\t\t},\n\t\tupdate: (speed, i) => {\n\t\t\tthis.track_info.speed_max = this.track_info.speed_max || -Infinity; // Speed Max\n\t\t\tthis.track_info.speed_min = this.track_info.speed_min || +Infinity; // Speed Min\n\t\t\tthis.track_info.speed_avg = this.track_info.speed_avg || 0;         // Speed Avg\n\n\t\t\tlet data  = this._data;\n\t\t\tlet track = this.track_info;\n\n\t\t\t// Try to smooth \"crazy\" speed values.\n\t\t\tif (this.options.speedDeltaMax) {\n\t\t\t\tlet delta    = speed - data[i > 0 ? i - 1 : i].speed;\n\t\t\t\tlet deltaMax = this.options.speedDeltaMax;\n\t\t\t\tif (Math.abs(delta) > deltaMax) {\n\t\t\t\t\tspeed       = data[i - 1].speed + deltaMax * Math.sign(delta);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t// Range of acceptable speed values.\n\t\t\tspeed = _.clamp(speed, this.options.speedRange);\n\n\t\t\tif (speed > track.speed_max) track.speed_max = speed;\n\t\t\tif (speed < track.speed_min) track.speed_min = speed;\n\n\t\t\ttrack.speed_avg = (speed + track.speed_avg) / 2.0;\n\n\t\t\treturn L.Util.formatNum(speed, 2);\n\t\t},\n\t});\n\n\tif (this.options.speed && this.options.speed != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : 0,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : speed.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : \"speed\",\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname         : 'speed',\n\t\t\tlabel        : 'Speed',\n\t\t\tyAttr        : \"speed\",\n\t\t\tscaleX       : 'distance',\n\t\t\tscaleY       : 'speed',\n\t\t\tcolor        : '#03ffff',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tif (this.options.speed) {\n\n\t\tthis._registerTooltip({\n\t\t\tname: 'speed',\n\t\t\tchart: (item) => L._('v: ') + item.speed + \" \" + speed.label,\n\t\t\tmarker: (item) => Math.round(item.speed) + \" \" + speed.label,\n\t\t\torder: 50,\n\t\t});\n\n\t\tthis._registerSummary({\n\t\t\t\"minspeed\"  : {\n\t\t\t\tlabel: \"Min Speed: \",\n\t\t\t\tvalue: (track) => Math.round(track.speed_min || 0) + '&nbsp;' + speed.label,\n\t\t\t\torder: 50\n\t\t\t},\n\t\t\t\"maxspeed\"  : {\n\t\t\t\tlabel: \"Max Speed: \",\n\t\t\t\tvalue: (track) => Math.round(track.speed_max || 0) + '&nbsp;' + speed.label,\n\t\t\t\torder: 50\n\t\t\t},\n\t\t\t\"avgspeed\": {\n\t\t\t\tlabel: \"Avg Speed: \",\n\t\t\t\tvalue: (track) => Math.round(track.speed_avg || 0) + '&nbsp;' + speed.label,\n\t\t\t\torder: 50\n\t\t\t}\n\t\t});\n\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.acceleration) return;\n\n\tlet opts = this.options;\n\tlet acceleration = {};\n\n\tacceleration.label      = opts.accelerationLabel  || L._(opts.imperial ? 'ft/s' : 'm/s');\n\topts.accelerationFactor = opts.accelerationFactor || 1;\n\n\tthis._registerDataAttribute({\n\t\tname: 'acceleration',\n\t\tinit: () => {\n\t\t\t// this.track_info.acceleration_max = -Infinity; // Acceleration Max\n\t\t\t// this.track_info.acceleration_min = +Infinity; // Acceleration Min\n\t\t\t// this.track_info.acceleration_avg = 0;         // Acceleration Avg\n\t\t},\n\t\tfetch: (i) => {\n\t\t\tlet data   = this._data;\n\t\t\tlet dv     = (data[i].speed - data[i > 0 ? i - 1 : i].speed) * (1000 / opts.timeFactor);\n\t\t\tlet dt     = (data[i].time - data[i > 0 ? i - 1 : i].time) / 1000;\n\t\t\treturn dt > 0 ? Math.abs((dv / dt)) * opts.accelerationFactor : 0;\n\t\t},\n\t\tupdate: (acceleration, i) => {\n\t\t\tthis.track_info.acceleration_max = this.track_info.acceleration_max || -Infinity; // Acceleration Max\n\t\t\tthis.track_info.acceleration_min = this.track_info.acceleration_min || +Infinity; // Acceleration Min\n\t\t\tthis.track_info.acceleration_avg = this.track_info.acceleration_avg || 0;         // Acceleration Avg\n\n\t\t\tlet data  = this._data;\n\t\t\tlet track = this.track_info;\n\n\t\t\t// Try to smooth \"crazy\" acceleration values.\n\t\t\tif (this.options.accelerationDeltaMax) {\n\t\t\t\tlet delta    = acceleration - data[i > 0 ? i - 1 : i].acceleration;\n\t\t\t\tlet deltaMax = this.options.accelerationDeltaMax;\n\t\t\t\tif (Math.abs(delta) > deltaMax) {\n\t\t\t\t\tacceleration = data[i - 1].acceleration + deltaMax * Math.sign(delta);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Range of acceptable acceleration values.\n\t\t\tacceleration = _.clamp(acceleration, this.options.accelerationRange);\n\t\n\t\t\tif (acceleration > track.acceleration_max) track.acceleration_max = acceleration;\n\t\t\tif (acceleration < track.acceleration_min) track.acceleration_min = acceleration;\n\n\t\t\ttrack.acceleration_avg = (acceleration + track.acceleration_avg) / 2.0;\n\n\t\t\treturn L.Util.formatNum(acceleration, 2);\n\t\t},\n\t});\n\n\tif (this.options.acceleration != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : 0,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : acceleration.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : 'acceleration',\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname         : 'acceleration',\n\t\t\tlabel        : 'Acceleration',\n\t\t\tyAttr        : 'acceleration',\n\t\t\tscaleX       : 'distance',\n\t\t\tscaleY       : 'acceleration',\n\t\t\tcolor        : '#050402',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tthis._registerTooltip({\n\t\tname  : 'acceleration',\n\t\tchart: (item) => L._(\"a: \") + item.acceleration + \" \" + acceleration.label,\n\t\tmarker: (item) => Math.round(item.acceleration) + \" \" + acceleration.label,\n\t\torder: 60,\n\t});\n\n\tthis._registerSummary({\n\t\t\"minacceleration\"  : {\n\t\t\tlabel: \"Min Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_min || 0) + '&nbsp;' + acceleration.label,\n\t\t\torder: 60\n\t\t},\n\t\t\"maxacceleration\"  : {\n\t\t\tlabel: \"Max Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_max || 0) + '&nbsp;' + acceleration.label,\n\t\t\torder: 60\n\t\t},\n\t\t\"avgacceleration\": {\n\t\t\tlabel: \"Avg Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_avg || 0) + '&nbsp;' + acceleration.label,\n\t\t\torder: 60\n\t\t}\n\t});\n\n});\n","/*\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\n *\n *  This file is free software: you may copy, redistribute and/or modify it\n *  under the terms of the GNU General Public License as published by the\n *  Free Software Foundation, either version 2 of the License, or (at your\n *  option) any later version.\n *\n *  This file is distributed in the hope that it will be useful, but\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see .\n *\n * This file incorporates work covered by the following copyright and\n * permission notice:\n *\n *     Copyright (c) 2013-2016, MIT License, Felix MrMufflon Bache\n *\n *     Permission to use, copy, modify, and/or distribute this software\n *     for any purpose with or without fee is hereby granted, provided\n *     that the above copyright notice and this permission notice appear\n *     in all copies.\n *\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Elevation } from './control';\nimport './distance';\nimport './time';\nimport './altitude';\nimport './slope';\nimport './speed';\nimport './acceleration';\n\nElevation.Utils = _;\nElevation.Components = D3;\nElevation.Chart = Chart;\n\n/* Temporary fix for empty values evaluated as false (leaflet-i18n v0.3.1) */\n(function(){\n\tlet proto = L.i18n.bind({});\n\tL.i18n = L._ = (string, data) => {\n\t\tif (L.locale && L.locales[L.locale] && L.locales[L.locale][string] == \"\") {\n\t\t\tL.locales[L.locale][string] = \"\\u200B\";\n\t\t}\n\t\treturn proto.call(null, string, data);\n\t};\n})();\n\n// Alias deprecated functions\n Elevation.addInitHook(function() {\n\tthis.enableDragging      = this.enableBrush;\n\tthis.disableDragging     = this.disableBrush;\n\tthis.loadChart           = this.addTo;\n\tthis.loadData            = this.load;\n\tthis.loadGPX             = this.load;\n\tthis.loadGeoJSON         = this.load;\n\tthis.loadXML             = this.load;\n\tthis.loadFile            = this.load;\n\tthis._addGPXData         = this._addGeoJSONData;\n\tthis._registerFocusLabel = this._registerTooltip;\n});\n\nL.control.elevation = (options) => new Elevation(options);\n"],"names":["factory","window","define","amd","exports","module","require","L","locales","locale","registerLocale","code","Util","extend","setLocale","i18n","_","translate","string","data","template","err","SEC","MIN","HOUR","DAY","formatTime","t","d","Math","floor","h","m","s","round","toString","padStart","saveFile","dataURI","fileName","a","create","href","target","download","style","b","document","body","appendChild","click","removeChild","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","addEventListener","once","src","head","drawCanvas","ctx","path","classed","beginPath","moveTo","p","Path2D","attr","strokeStyle","fillStyle","lineWidth","globalCompositeOperation","globalAlpha","stroke","fill","closePath","clamp","val","range","addClass","targetNode","className","split","every","DomUtil","removeClass","toggleClass","conditional","call","replaceClass","removeClassName","addClassName","name","value","getStyle","setProperty","toggleStyle","toggleEvent","leafletElement","eventName","handler","tagName","attributes","parent","elem","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","context","querySelector","on","DomEvent","off","hasClass","randomId","random","substr","each","obj","fn","i","Colors","area","alpha","line","Area","width","height","xAttr","yAttr","scaleX","scaleY","interpolation","d3","curve","x","xDiagCoord","y0","y1","Path","color","strokeColor","strokeOpacity","fillOpacity","Axis","type","tickSize","tickPadding","axis","scale","ticks","tickFormat","label","labelX","labelY","onAxisMount","g","w","axisScale","replace","l","toUpperCase","axisGroup","join","text","Grid","props","PositionMarker","theme","xCoord","yCoord","labels","item","length","circle","node","isNaN","Object","keys","sort","order","forEach","size","selectAll","LegendItem","margins","toLowerCase","ownerSVGElement","dispatch","detail","legend","enabled","bottom","Tooltip","box","rect","xAlign","yAlign","bbox","getBBox","e","max","Browser","webkit","Infinity","Ruler","y","symbol","symbolTriangle","exit","remove","enter","merge","angle","CheckPoint","point","property","datum","pos","y2","x2","Domain","min","forceBounds","domain","extent","Range","Scale","scaleLinear","Bisect","bisector","left","invert","Chart","ruler","_width","right","_height","top","svg","panes","grid","brush","tooltip","mask","maskRect","foreignObject","canvas","getContext","brushX","opts","utils","chart","_resize","test","navigator","platform","userAgent","pane","get","Class","includes","Evented","prototype","Mixin","Events","initialize","control","options","_data","_props","scales","paths","areas","grids","axes","legendItems","tooltipItems","_scales","_domains","_ranges","_paths","_brushEnabled","dragging","_zoomEnabled","zooming","_chart","D3","_container","_grid","_area","_point","_axis","_legend","_tooltip","_ruler","_initScale","_mask","_context","_brush","_zoom","zoom","_drag","drag","_initInteractions","_maskGaps","push","index","update","_updateScale","_updateArea","_updateAxis","_updateLegend","_updateClipper","render","container","clear","_resetDrag","_hideDiagramIndicator","clearRect","_drawPath","preferCanvas","_hasActiveLayers","_initBrush","selection","start","_findIndexForXCoord","end","fire","dragstart","dragend","focus","sourceEvent","coords","pointers","filter","shiftKey","button","bind","_initClipper","margin","onStart","transform","onEnd","onZoom","distance","_x","rescaleX","time","scaleExtent","translateExtent","buttons","_initRuler","_initLegend","formatNum","format","yMax","z","_y","imperial","_findCoordsForY","_registerAxisScale","xAxisMin","xAxisMax","yAxisMin","yAxisMax","altitude","_registerAreaPath","_registerAxisGrid","forceAxisBounds","xTicks","yTicks","_registerCheckPoint","latlng","_findIndexForLatLng","dist","_registerTooltip","gridOpts","axesOpts","n","substring","indexOf","d1","d2","x1","legends","items","nodes","v","Array","map","sign","rev","slice","reverse","concat","xAxesB","marginB","marginR","tx","ty","list","reduce","array","next","curr","result","distanceTo","_resetZoom","zoomIdentity","_showDiagramIndicator","xCoordinate","Marker","marker","_marker","icon","markerIcon","zIndexOffset","interactive","_labels","addTo","_map","getPane","_latlng","latLngToLayerPoint","_rotate","rotatedPointToMapPanePoint","maxElevation","getElement","setLatLng","getLatLng","Summary","summary","reset","innerHTML","track_info","_registerSummary","Options","autofitBounds","autohide","mobile","autohideMarker","almostover","collapsed","detached","distanceMarkers","lazy","direction","decimalsX","decimalsY","downloadLink","elevationDiv","followMarker","lazyLoadJS","divIcon","html","iconSize","iconAnchor","polyline","opacity","weight","lineCap","polylineSegments","reverseCoords","skipNullZCoords","slope","slopeDeltaMax","undefined","slopeRange","speed","speedDeltaMax","speedRange","timeFactor","timeFormat","timestamps","waypoints","wptIcons","wptLabels","xLabel","yLabel","zFollow","Mobile","Elevation","Control","__mileFactor","__footFactor","__D3","__TOGEOJSON","__LGEOMUTIL","__LALMOSTOVER","__LDISTANCEM","addData","layer","lazyLoad","then","_addData","_addLayer","_fireEvt","eleDiv","_initElevationDiv","isConnected","getContainer","onAdd","_clearChart","_layers","_clearLayers","_markers","_clearMarkers","_updateChart","_events","elechart_updated","eachLayer","clearLayers","disableBrush","enableBrush","disableZoom","enableZoom","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","hide","featureGroup","_markedSegments","_chartEnabled","handlers","setOptions","_setMapView","throttle","setStyle","colors","_fixCanvasPaths","_fixTooltipSize","condition","toGeoJSON","GeometryUtil","Handler","AlmostOver","DistanceMarkers","load","_parseFromString","geojson","_loadLayer","_loadFile","_initButton","_initChart","_initSummary","_initMarker","_initLayer","_hideMarker","_resetView","_resizeChart","_rotateMarker","_keydownHandler","_updateSummary","onRemove","redraw","setZFollow","show","geom","geometry","_addGeoJSONData","coordinates","console","warn","features","feature","_latlngs","properties","meta","ele","hr","cad","atemp","coordinateProperties","id","_addPoint","lat","lng","alt","latLng","addLayer","Polyline","_addMarker","_initAlmostOverHandler","almostOver","addHandler","_mousemoveLayerHandler","_mouseoutHandler","_initDistanceMarkers","_initMapIntegrations","_collapse","_expand","oldProto","Canvas","_fillStroke","include","hasLayer","oldVal","outline","_updateMarker","_findItemForLatLng","_findItemForX","propagate","_xTicks","_yTicks","offsetWidth","offsetHeight","clientWidth","_maxWidth","maxWidth","_mouseenterHandler","_dragendHandler","_mousemoveHandler","_rulerFilterHandler","_toggleChartHandler","_pane","createPane","zIndex","pointerEvents","_renderer","disableClickPropagation","disableScrollPropagation","link","_button","title","stop","_toggle","_summary","key","fetch","response","_downloadURL","catch","geoJson","pointToLayer","prop","desc","sym","hasOwnProperty","content","decodeURI","bindPopup","keepInView","openPopup","bindTooltip","sticky","openTooltip","element","onEachFeature","_parseFromGeoJSONString","JSON","parse","_parseFromXMLString","trim","_prepareMultiLineStrings","_prepareAdditionalProperties","xml","DOMParser","parseFromString","documentElement","getElementsByTagName","from","find","parentElement","textContent","pop","feauture","_registerDataAttribute","lastValid","init","skipNull","prev","splice","_isFullscreen","newWidth","_updateMapSegments","getZoom","setView","animate","duration","contains","elevation_max","setLatLngs","onclick","preventDefault","event","confirm","CustomEvent","dispatchEvent","__xTicks","__yTicks","addInitHook","distanceFactor","delta","track","toFixed","timeLabel","_timeAVGSpeed","timeAVGSpeed","speedFactor","Date","toLocaleString","replaceAll","toLocaleTimeString","toLocaleDateString","xTimeFormat","coordTimes","times","dx","t0","getTime","dt","now","getTimezoneOffset","abs","altitudeFactor","heightFactor","elevation_min","elevation_avg","altitudeDeltaMax","deltaMax","altitudeRange","visbile","slopeLabel","dz","ascent","descent","slope_max","slope_min","slope_avg","slop","acceleration","speedLabel","speed_max","speed_min","speed_avg","accelerationLabel","accelerationFactor","dv","acceleration_max","acceleration_min","acceleration_avg","accelerationDeltaMax","accelerationRange","Utils","Components","proto","enableDragging","disableDragging","loadChart","loadData","loadGPX","loadGeoJSON","loadXML","loadFile","_addGPXData","_registerFocusLabel","elevation"],"mappings":"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"}